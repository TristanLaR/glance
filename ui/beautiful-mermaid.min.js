(()=>{var yt=Object.create;var He=Object.defineProperty;var bt=Object.getOwnPropertyDescriptor;var wt=Object.getOwnPropertyNames;var vt=Object.getPrototypeOf,$t=Object.prototype.hasOwnProperty;var kt=(e,n,s)=>n in e?He(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var pe=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(n,s)=>(typeof require<"u"?require:n)[s]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Et=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var Ct=(e,n,s,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of wt(n))!$t.call(e,r)&&r!==s&&He(e,r,{get:()=>n[r],enumerable:!(t=bt(n,r))||t.enumerable});return e};var Mt=(e,n,s)=>(s=e!=null?yt(vt(e)):{},Ct(n||!e||!e.__esModule?He(s,"default",{value:e,enumerable:!0}):s,e));var J=(e,n,s)=>kt(e,typeof n!="symbol"?n+"":n,s);var Ve=Et((Ge,Ye)=>{(function(e){if(typeof Ge=="object"&&typeof Ye<"u")Ye.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.dagre=e()}})(function(){var e,n,s;return(function(){function t(r,h,x){function d(a,u){if(!h[a]){if(!r[a]){var o=typeof pe=="function"&&pe;if(!u&&o)return o(a,!0);if(p)return p(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var i=h[a]={exports:{}};r[a][0].call(i.exports,function(m){var f=r[a][1][m];return d(f||m)},i,i.exports,t,r,h,x)}return h[a].exports}for(var p=typeof pe=="function"&&pe,g=0;g<x.length;g++)d(x[g]);return d}return t})()({1:[function(t,r,h){r.exports={graphlib:t("@dagrejs/graphlib"),layout:t("./lib/layout"),debug:t("./lib/debug"),util:{time:t("./lib/util").time,notime:t("./lib/util").notime},version:t("./lib/version")}},{"./lib/debug":6,"./lib/layout":8,"./lib/util":27,"./lib/version":28,"@dagrejs/graphlib":29}],2:[function(t,r,h){"use strict";let x=t("./greedy-fas"),d=t("./util").uniqueId;r.exports={run:p,undo:a};function p(u){(u.graph().acyclicer==="greedy"?x(u,l(u)):g(u)).forEach(i=>{let m=u.edge(i);u.removeEdge(i),m.forwardName=i.name,m.reversed=!0,u.setEdge(i.w,i.v,m,d("rev"))});function l(i){return m=>i.edge(m).weight}}function g(u){let o=[],l={},i={};function m(f){Object.hasOwn(i,f)||(i[f]=!0,l[f]=!0,u.outEdges(f).forEach(c=>{Object.hasOwn(l,c.w)?o.push(c):m(c.w)}),delete l[f])}return u.nodes().forEach(m),o}function a(u){u.edges().forEach(o=>{let l=u.edge(o);if(l.reversed){u.removeEdge(o);let i=l.forwardName;delete l.reversed,delete l.forwardName,u.setEdge(o.w,o.v,l,i)}})}},{"./greedy-fas":7,"./util":27}],3:[function(t,r,h){let x=t("./util");r.exports=d;function d(g){function a(u){let o=g.children(u),l=g.node(u);if(o.length&&o.forEach(a),Object.hasOwn(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(let i=l.minRank,m=l.maxRank+1;i<m;++i)p(g,"borderLeft","_bl",u,l,i),p(g,"borderRight","_br",u,l,i)}}g.children().forEach(a)}function p(g,a,u,o,l,i){let m={width:0,height:0,rank:i,borderType:a},f=l[a][i-1],c=x.addDummyNode(g,"border",m,u);l[a][i]=c,g.setParent(c,o),f&&g.setEdge(f,c,{weight:1})}},{"./util":27}],4:[function(t,r,h){"use strict";r.exports={adjust:x,undo:d};function x(i){let m=i.graph().rankdir.toLowerCase();(m==="lr"||m==="rl")&&p(i)}function d(i){let m=i.graph().rankdir.toLowerCase();(m==="bt"||m==="rl")&&a(i),(m==="lr"||m==="rl")&&(o(i),p(i))}function p(i){i.nodes().forEach(m=>g(i.node(m))),i.edges().forEach(m=>g(i.edge(m)))}function g(i){let m=i.width;i.width=i.height,i.height=m}function a(i){i.nodes().forEach(m=>u(i.node(m))),i.edges().forEach(m=>{let f=i.edge(m);f.points.forEach(u),Object.hasOwn(f,"y")&&u(f)})}function u(i){i.y=-i.y}function o(i){i.nodes().forEach(m=>l(i.node(m))),i.edges().forEach(m=>{let f=i.edge(m);f.points.forEach(l),Object.hasOwn(f,"x")&&l(f)})}function l(i){let m=i.x;i.x=i.y,i.y=m}},{}],5:[function(t,r,h){class x{constructor(){let a={};a._next=a._prev=a,this._sentinel=a}dequeue(){let a=this._sentinel,u=a._prev;if(u!==a)return d(u),u}enqueue(a){let u=this._sentinel;a._prev&&a._next&&d(a),a._next=u._next,u._next._prev=a,u._next=a,a._prev=u}toString(){let a=[],u=this._sentinel,o=u._prev;for(;o!==u;)a.push(JSON.stringify(o,p)),o=o._prev;return"["+a.join(", ")+"]"}}function d(g){g._prev._next=g._next,g._next._prev=g._prev,delete g._next,delete g._prev}function p(g,a){if(g!=="_next"&&g!=="_prev")return a}r.exports=x},{}],6:[function(t,r,h){let x=t("./util"),d=t("@dagrejs/graphlib").Graph;r.exports={debugOrdering:p};function p(g){let a=x.buildLayerMatrix(g),u=new d({compound:!0,multigraph:!0}).setGraph({});return g.nodes().forEach(o=>{u.setNode(o,{label:o}),u.setParent(o,"layer"+g.node(o).rank)}),g.edges().forEach(o=>u.setEdge(o.v,o.w,{},o.name)),a.forEach((o,l)=>{let i="layer"+l;u.setNode(i,{rank:"same"}),o.reduce((m,f)=>(u.setEdge(m,f,{style:"invis"}),f))}),u}},{"./util":27,"@dagrejs/graphlib":29}],7:[function(t,r,h){let x=t("@dagrejs/graphlib").Graph,d=t("./data/list");r.exports=g;let p=()=>1;function g(m,f){if(m.nodeCount()<=1)return[];let c=o(m,f||p);return a(c.graph,c.buckets,c.zeroIdx).flatMap(w=>m.outEdges(w.v,w.w))}function a(m,f,c){let b=[],w=f[f.length-1],E=f[0],L;for(;m.nodeCount();){for(;L=E.dequeue();)u(m,f,c,L);for(;L=w.dequeue();)u(m,f,c,L);if(m.nodeCount()){for(let y=f.length-2;y>0;--y)if(L=f[y].dequeue(),L){b=b.concat(u(m,f,c,L,!0));break}}}return b}function u(m,f,c,b,w){let E=w?[]:void 0;return m.inEdges(b.v).forEach(L=>{let y=m.edge(L),v=m.node(L.v);w&&E.push({v:L.v,w:L.w}),v.out-=y,l(f,c,v)}),m.outEdges(b.v).forEach(L=>{let y=m.edge(L),v=L.w,k=m.node(v);k.in-=y,l(f,c,k)}),m.removeNode(b.v),E}function o(m,f){let c=new x,b=0,w=0;m.nodes().forEach(y=>{c.setNode(y,{v:y,in:0,out:0})}),m.edges().forEach(y=>{let v=c.edge(y.v,y.w)||0,k=f(y),M=v+k;c.setEdge(y.v,y.w,M),w=Math.max(w,c.node(y.v).out+=k),b=Math.max(b,c.node(y.w).in+=k)});let E=i(w+b+3).map(()=>new d),L=b+1;return c.nodes().forEach(y=>{l(E,L,c.node(y))}),{graph:c,buckets:E,zeroIdx:L}}function l(m,f,c){c.out?c.in?m[c.out-c.in+f].enqueue(c):m[m.length-1].enqueue(c):m[0].enqueue(c)}function i(m){let f=[];for(let c=0;c<m;c++)f.push(c);return f}},{"./data/list":5,"@dagrejs/graphlib":29}],8:[function(t,r,h){"use strict";let x=t("./acyclic"),d=t("./normalize"),p=t("./rank"),g=t("./util").normalizeRanks,a=t("./parent-dummy-chains"),u=t("./util").removeEmptyRanks,o=t("./nesting-graph"),l=t("./add-border-segments"),i=t("./coordinate-system"),m=t("./order"),f=t("./position"),c=t("./util"),b=t("@dagrejs/graphlib").Graph;r.exports=w;function w(_,H){let A=H&&H.debugTiming?c.time:c.notime;A("layout",()=>{let N=A("  buildLayoutGraph",()=>$(_));A("  runLayout",()=>E(N,A,H)),A("  updateInputGraph",()=>L(_,N))})}function E(_,H,A){H("    makeSpaceForEdgeLabels",()=>C(_)),H("    removeSelfEdges",()=>Te(_)),H("    acyclic",()=>x.run(_)),H("    nestingGraph.run",()=>o.run(_)),H("    rank",()=>p(c.asNonCompoundGraph(_))),H("    injectEdgeLabelProxies",()=>O(_)),H("    removeEmptyRanks",()=>u(_)),H("    nestingGraph.cleanup",()=>o.cleanup(_)),H("    normalizeRanks",()=>g(_)),H("    assignRankMinMax",()=>S(_)),H("    removeEdgeLabelProxies",()=>R(_)),H("    normalize.run",()=>d.run(_)),H("    parentDummyChains",()=>a(_)),H("    addBorderSegments",()=>l(_)),H("    order",()=>m(_,A)),H("    insertSelfEdges",()=>be(_)),H("    adjustCoordinateSystem",()=>i.adjust(_)),H("    position",()=>f(_)),H("    positionSelfEdges",()=>we(_)),H("    removeBorderNodes",()=>re(_)),H("    normalize.undo",()=>d.undo(_)),H("    fixupEdgeLabelCoords",()=>F(_)),H("    undoCoordinateSystem",()=>i.undo(_)),H("    translateGraph",()=>j(_)),H("    assignNodeIntersects",()=>W(_)),H("    reversePoints",()=>ee(_)),H("    acyclic.undo",()=>x.undo(_))}function L(_,H){_.nodes().forEach(A=>{let N=_.node(A),P=H.node(A);N&&(N.x=P.x,N.y=P.y,N.rank=P.rank,H.children(A).length&&(N.width=P.width,N.height=P.height))}),_.edges().forEach(A=>{let N=_.edge(A),P=H.edge(A);N.points=P.points,Object.hasOwn(P,"x")&&(N.x=P.x,N.y=P.y)}),_.graph().width=H.graph().width,_.graph().height=H.graph().height}let y=["nodesep","edgesep","ranksep","marginx","marginy"],v={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},k=["acyclicer","ranker","rankdir","align"],M=["width","height","rank"],I={width:0,height:0},Y=["minlen","weight","width","height","labeloffset"],T={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},D=["labelpos"];function $(_){let H=new b({multigraph:!0,compound:!0}),A=Re(_.graph());return H.setGraph(Object.assign({},v,fe(A,y),c.pick(A,k))),_.nodes().forEach(N=>{let P=Re(_.node(N)),G=fe(P,M);Object.keys(I).forEach(U=>{G[U]===void 0&&(G[U]=I[U])}),H.setNode(N,G),H.setParent(N,_.parent(N))}),_.edges().forEach(N=>{let P=Re(_.edge(N));H.setEdge(N,Object.assign({},T,fe(P,Y),c.pick(P,D)))}),H}function C(_){let H=_.graph();H.ranksep/=2,_.edges().forEach(A=>{let N=_.edge(A);N.minlen*=2,N.labelpos.toLowerCase()!=="c"&&(H.rankdir==="TB"||H.rankdir==="BT"?N.width+=N.labeloffset:N.height+=N.labeloffset)})}function O(_){_.edges().forEach(H=>{let A=_.edge(H);if(A.width&&A.height){let N=_.node(H.v),G={rank:(_.node(H.w).rank-N.rank)/2+N.rank,e:H};c.addDummyNode(_,"edge-proxy",G,"_ep")}})}function S(_){let H=0;_.nodes().forEach(A=>{let N=_.node(A);N.borderTop&&(N.minRank=_.node(N.borderTop).rank,N.maxRank=_.node(N.borderBottom).rank,H=Math.max(H,N.maxRank))}),_.graph().maxRank=H}function R(_){_.nodes().forEach(H=>{let A=_.node(H);A.dummy==="edge-proxy"&&(_.edge(A.e).labelRank=A.rank,_.removeNode(H))})}function j(_){let H=Number.POSITIVE_INFINITY,A=0,N=Number.POSITIVE_INFINITY,P=0,G=_.graph(),U=G.marginx||0,te=G.marginy||0;function Xe(ne){let Z=ne.x,ue=ne.y,ze=ne.width,Fe=ne.height;H=Math.min(H,Z-ze/2),A=Math.max(A,Z+ze/2),N=Math.min(N,ue-Fe/2),P=Math.max(P,ue+Fe/2)}_.nodes().forEach(ne=>Xe(_.node(ne))),_.edges().forEach(ne=>{let Z=_.edge(ne);Object.hasOwn(Z,"x")&&Xe(Z)}),H-=U,N-=te,_.nodes().forEach(ne=>{let Z=_.node(ne);Z.x-=H,Z.y-=N}),_.edges().forEach(ne=>{let Z=_.edge(ne);Z.points.forEach(ue=>{ue.x-=H,ue.y-=N}),Object.hasOwn(Z,"x")&&(Z.x-=H),Object.hasOwn(Z,"y")&&(Z.y-=N)}),G.width=A-H+U,G.height=P-N+te}function W(_){_.edges().forEach(H=>{let A=_.edge(H),N=_.node(H.v),P=_.node(H.w),G,U;A.points?(G=A.points[0],U=A.points[A.points.length-1]):(A.points=[],G=P,U=N),A.points.unshift(c.intersectRect(N,G)),A.points.push(c.intersectRect(P,U))})}function F(_){_.edges().forEach(H=>{let A=_.edge(H);if(Object.hasOwn(A,"x"))switch((A.labelpos==="l"||A.labelpos==="r")&&(A.width-=A.labeloffset),A.labelpos){case"l":A.x-=A.width/2+A.labeloffset;break;case"r":A.x+=A.width/2+A.labeloffset;break}})}function ee(_){_.edges().forEach(H=>{let A=_.edge(H);A.reversed&&A.points.reverse()})}function re(_){_.nodes().forEach(H=>{if(_.children(H).length){let A=_.node(H),N=_.node(A.borderTop),P=_.node(A.borderBottom),G=_.node(A.borderLeft[A.borderLeft.length-1]),U=_.node(A.borderRight[A.borderRight.length-1]);A.width=Math.abs(U.x-G.x),A.height=Math.abs(P.y-N.y),A.x=G.x+A.width/2,A.y=N.y+A.height/2}}),_.nodes().forEach(H=>{_.node(H).dummy==="border"&&_.removeNode(H)})}function Te(_){_.edges().forEach(H=>{if(H.v===H.w){var A=_.node(H.v);A.selfEdges||(A.selfEdges=[]),A.selfEdges.push({e:H,label:_.edge(H)}),_.removeEdge(H)}})}function be(_){var H=c.buildLayerMatrix(_);H.forEach(A=>{var N=0;A.forEach((P,G)=>{var U=_.node(P);U.order=G+N,(U.selfEdges||[]).forEach(te=>{c.addDummyNode(_,"selfedge",{width:te.label.width,height:te.label.height,rank:U.rank,order:G+ ++N,e:te.e,label:te.label},"_se")}),delete U.selfEdges})})}function we(_){_.nodes().forEach(H=>{var A=_.node(H);if(A.dummy==="selfedge"){var N=_.node(A.e.v),P=N.x+N.width/2,G=N.y,U=A.x-P,te=N.height/2;_.setEdge(A.e,A.label),_.removeNode(H),A.label.points=[{x:P+2*U/3,y:G-te},{x:P+5*U/6,y:G-te},{x:P+U,y:G},{x:P+5*U/6,y:G+te},{x:P+2*U/3,y:G+te}],A.label.x=A.x,A.label.y=A.y}})}function fe(_,H){return c.mapValues(c.pick(_,H),Number)}function Re(_){var H={};return _&&Object.entries(_).forEach(([A,N])=>{typeof A=="string"&&(A=A.toLowerCase()),H[A]=N}),H}},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./nesting-graph":9,"./normalize":10,"./order":15,"./parent-dummy-chains":20,"./position":22,"./rank":24,"./util":27,"@dagrejs/graphlib":29}],9:[function(t,r,h){let x=t("./util");r.exports={run:d,cleanup:u};function d(o){let l=x.addDummyNode(o,"root",{},"_root"),i=g(o),m=Object.values(i),f=x.applyWithChunking(Math.max,m)-1,c=2*f+1;o.graph().nestingRoot=l,o.edges().forEach(w=>o.edge(w).minlen*=c);let b=a(o)+1;o.children().forEach(w=>p(o,l,c,b,f,i,w)),o.graph().nodeRankFactor=c}function p(o,l,i,m,f,c,b){let w=o.children(b);if(!w.length){b!==l&&o.setEdge(l,b,{weight:0,minlen:i});return}let E=x.addBorderNode(o,"_bt"),L=x.addBorderNode(o,"_bb"),y=o.node(b);o.setParent(E,b),y.borderTop=E,o.setParent(L,b),y.borderBottom=L,w.forEach(v=>{p(o,l,i,m,f,c,v);let k=o.node(v),M=k.borderTop?k.borderTop:v,I=k.borderBottom?k.borderBottom:v,Y=k.borderTop?m:2*m,T=M!==I?1:f-c[b]+1;o.setEdge(E,M,{weight:Y,minlen:T,nestingEdge:!0}),o.setEdge(I,L,{weight:Y,minlen:T,nestingEdge:!0})}),o.parent(b)||o.setEdge(l,E,{weight:0,minlen:f+c[b]})}function g(o){var l={};function i(m,f){var c=o.children(m);c&&c.length&&c.forEach(b=>i(b,f+1)),l[m]=f}return o.children().forEach(m=>i(m,1)),l}function a(o){return o.edges().reduce((l,i)=>l+o.edge(i).weight,0)}function u(o){var l=o.graph();o.removeNode(l.nestingRoot),delete l.nestingRoot,o.edges().forEach(i=>{var m=o.edge(i);m.nestingEdge&&o.removeEdge(i)})}},{"./util":27}],10:[function(t,r,h){"use strict";let x=t("./util");r.exports={run:d,undo:g};function d(a){a.graph().dummyChains=[],a.edges().forEach(u=>p(a,u))}function p(a,u){let o=u.v,l=a.node(o).rank,i=u.w,m=a.node(i).rank,f=u.name,c=a.edge(u),b=c.labelRank;if(m===l+1)return;a.removeEdge(u);let w,E,L;for(L=0,++l;l<m;++L,++l)c.points=[],E={width:0,height:0,edgeLabel:c,edgeObj:u,rank:l},w=x.addDummyNode(a,"edge",E,"_d"),l===b&&(E.width=c.width,E.height=c.height,E.dummy="edge-label",E.labelpos=c.labelpos),a.setEdge(o,w,{weight:c.weight},f),L===0&&a.graph().dummyChains.push(w),o=w;a.setEdge(o,i,{weight:c.weight},f)}function g(a){a.graph().dummyChains.forEach(u=>{let o=a.node(u),l=o.edgeLabel,i;for(a.setEdge(o.edgeObj,l);o.dummy;)i=a.successors(u)[0],a.removeNode(u),l.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(l.x=o.x,l.y=o.y,l.width=o.width,l.height=o.height),u=i,o=a.node(u)})}},{"./util":27}],11:[function(t,r,h){r.exports=x;function x(d,p,g){let a={},u;g.forEach(o=>{let l=d.parent(o),i,m;for(;l;){if(i=d.parent(l),i?(m=a[i],a[i]=l):(m=u,u=l),m&&m!==l){p.setEdge(m,l);return}l=i}})}},{}],12:[function(t,r,h){r.exports=x;function x(d,p=[]){return p.map(g=>{let a=d.inEdges(g);if(a.length){let u=a.reduce((o,l)=>{let i=d.edge(l),m=d.node(l.v);return{sum:o.sum+i.weight*m.order,weight:o.weight+i.weight}},{sum:0,weight:0});return{v:g,barycenter:u.sum/u.weight,weight:u.weight}}else return{v:g}})}},{}],13:[function(t,r,h){let x=t("@dagrejs/graphlib").Graph,d=t("../util");r.exports=p;function p(a,u,o,l){l||(l=a.nodes());let i=g(a),m=new x({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(f=>a.node(f));return l.forEach(f=>{let c=a.node(f),b=a.parent(f);(c.rank===u||c.minRank<=u&&u<=c.maxRank)&&(m.setNode(f),m.setParent(f,b||i),a[o](f).forEach(w=>{let E=w.v===f?w.w:w.v,L=m.edge(E,f),y=L!==void 0?L.weight:0;m.setEdge(E,f,{weight:a.edge(w).weight+y})}),Object.hasOwn(c,"minRank")&&m.setNode(f,{borderLeft:c.borderLeft[u],borderRight:c.borderRight[u]}))}),m}function g(a){for(var u;a.hasNode(u=d.uniqueId("_root")););return u}},{"../util":27,"@dagrejs/graphlib":29}],14:[function(t,r,h){"use strict";let x=t("../util").zipObject;r.exports=d;function d(g,a){let u=0;for(let o=1;o<a.length;++o)u+=p(g,a[o-1],a[o]);return u}function p(g,a,u){let o=x(u,u.map((b,w)=>w)),l=a.flatMap(b=>g.outEdges(b).map(w=>({pos:o[w.w],weight:g.edge(w).weight})).sort((w,E)=>w.pos-E.pos)),i=1;for(;i<u.length;)i<<=1;let m=2*i-1;i-=1;let f=new Array(m).fill(0),c=0;return l.forEach(b=>{let w=b.pos+i;f[w]+=b.weight;let E=0;for(;w>0;)w%2&&(E+=f[w+1]),w=w-1>>1,f[w]+=b.weight;c+=b.weight*E}),c}},{"../util":27}],15:[function(t,r,h){"use strict";let x=t("./init-order"),d=t("./cross-count"),p=t("./sort-subgraph"),g=t("./build-layer-graph"),a=t("./add-subgraph-constraints"),u=t("@dagrejs/graphlib").Graph,o=t("../util");r.exports=l;function l(c,b){if(b&&typeof b.customOrder=="function"){b.customOrder(c,l);return}let w=o.maxRank(c),E=i(c,o.range(1,w+1),"inEdges"),L=i(c,o.range(w-1,-1,-1),"outEdges"),y=x(c);if(f(c,y),b&&b.disableOptimalOrderHeuristic)return;let v=Number.POSITIVE_INFINITY,k;for(let M=0,I=0;I<4;++M,++I){m(M%2?E:L,M%4>=2),y=o.buildLayerMatrix(c);let Y=d(c,y);Y<v&&(I=0,k=Object.assign({},y),v=Y)}f(c,k)}function i(c,b,w){let E=new Map,L=(y,v)=>{E.has(y)||E.set(y,[]),E.get(y).push(v)};for(let y of c.nodes()){let v=c.node(y);if(typeof v.rank=="number"&&L(v.rank,y),typeof v.minRank=="number"&&typeof v.maxRank=="number")for(let k=v.minRank;k<=v.maxRank;k++)k!==v.rank&&L(k,y)}return b.map(function(y){return g(c,y,w,E.get(y)||[])})}function m(c,b){let w=new u;c.forEach(function(E){let L=E.graph().root,y=p(E,L,w,b);y.vs.forEach((v,k)=>E.node(v).order=k),a(E,w,y.vs)})}function f(c,b){Object.values(b).forEach(w=>w.forEach((E,L)=>c.node(E).order=L))}},{"../util":27,"./add-subgraph-constraints":11,"./build-layer-graph":13,"./cross-count":14,"./init-order":16,"./sort-subgraph":18,"@dagrejs/graphlib":29}],16:[function(t,r,h){"use strict";let x=t("../util");r.exports=d;function d(p){let g={},a=p.nodes().filter(f=>!p.children(f).length),u=a.map(f=>p.node(f).rank),o=x.applyWithChunking(Math.max,u),l=x.range(o+1).map(()=>[]);function i(f){if(g[f])return;g[f]=!0;let c=p.node(f);l[c.rank].push(f),p.successors(f).forEach(i)}return a.sort((f,c)=>p.node(f).rank-p.node(c).rank).forEach(i),l}},{"../util":27}],17:[function(t,r,h){"use strict";let x=t("../util");r.exports=d;function d(a,u){let o={};a.forEach((i,m)=>{let f=o[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:m};i.barycenter!==void 0&&(f.barycenter=i.barycenter,f.weight=i.weight)}),u.edges().forEach(i=>{let m=o[i.v],f=o[i.w];m!==void 0&&f!==void 0&&(f.indegree++,m.out.push(o[i.w]))});let l=Object.values(o).filter(i=>!i.indegree);return p(l)}function p(a){let u=[];function o(i){return m=>{m.merged||(m.barycenter===void 0||i.barycenter===void 0||m.barycenter>=i.barycenter)&&g(i,m)}}function l(i){return m=>{m.in.push(i),--m.indegree===0&&a.push(m)}}for(;a.length;){let i=a.pop();u.push(i),i.in.reverse().forEach(o(i)),i.out.forEach(l(i))}return u.filter(i=>!i.merged).map(i=>x.pick(i,["vs","i","barycenter","weight"]))}function g(a,u){let o=0,l=0;a.weight&&(o+=a.barycenter*a.weight,l+=a.weight),u.weight&&(o+=u.barycenter*u.weight,l+=u.weight),a.vs=u.vs.concat(a.vs),a.barycenter=o/l,a.weight=l,a.i=Math.min(u.i,a.i),u.merged=!0}},{"../util":27}],18:[function(t,r,h){let x=t("./barycenter"),d=t("./resolve-conflicts"),p=t("./sort");r.exports=g;function g(o,l,i,m){let f=o.children(l),c=o.node(l),b=c?c.borderLeft:void 0,w=c?c.borderRight:void 0,E={};b&&(f=f.filter(k=>k!==b&&k!==w));let L=x(o,f);L.forEach(k=>{if(o.children(k.v).length){let M=g(o,k.v,i,m);E[k.v]=M,Object.hasOwn(M,"barycenter")&&u(k,M)}});let y=d(L,i);a(y,E);let v=p(y,m);if(b&&(v.vs=[b,v.vs,w].flat(!0),o.predecessors(b).length)){let k=o.node(o.predecessors(b)[0]),M=o.node(o.predecessors(w)[0]);Object.hasOwn(v,"barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+k.order+M.order)/(v.weight+2),v.weight+=2}return v}function a(o,l){o.forEach(i=>{i.vs=i.vs.flatMap(m=>l[m]?l[m].vs:m)})}function u(o,l){o.barycenter!==void 0?(o.barycenter=(o.barycenter*o.weight+l.barycenter*l.weight)/(o.weight+l.weight),o.weight+=l.weight):(o.barycenter=l.barycenter,o.weight=l.weight)}},{"./barycenter":12,"./resolve-conflicts":17,"./sort":19}],19:[function(t,r,h){let x=t("../util");r.exports=d;function d(a,u){let o=x.partition(a,E=>Object.hasOwn(E,"barycenter")),l=o.lhs,i=o.rhs.sort((E,L)=>L.i-E.i),m=[],f=0,c=0,b=0;l.sort(g(!!u)),b=p(m,i,b),l.forEach(E=>{b+=E.vs.length,m.push(E.vs),f+=E.barycenter*E.weight,c+=E.weight,b=p(m,i,b)});let w={vs:m.flat(!0)};return c&&(w.barycenter=f/c,w.weight=c),w}function p(a,u,o){let l;for(;u.length&&(l=u[u.length-1]).i<=o;)u.pop(),a.push(l.vs),o++;return o}function g(a){return(u,o)=>u.barycenter<o.barycenter?-1:u.barycenter>o.barycenter?1:a?o.i-u.i:u.i-o.i}},{"../util":27}],20:[function(t,r,h){r.exports=x;function x(g){let a=p(g);g.graph().dummyChains.forEach(u=>{let o=g.node(u),l=o.edgeObj,i=d(g,a,l.v,l.w),m=i.path,f=i.lca,c=0,b=m[c],w=!0;for(;u!==l.w;){if(o=g.node(u),w){for(;(b=m[c])!==f&&g.node(b).maxRank<o.rank;)c++;b===f&&(w=!1)}if(!w){for(;c<m.length-1&&g.node(b=m[c+1]).minRank<=o.rank;)c++;b=m[c]}g.setParent(u,b),u=g.successors(u)[0]}})}function d(g,a,u,o){let l=[],i=[],m=Math.min(a[u].low,a[o].low),f=Math.max(a[u].lim,a[o].lim),c,b;c=u;do c=g.parent(c),l.push(c);while(c&&(a[c].low>m||f>a[c].lim));for(b=c,c=o;(c=g.parent(c))!==b;)i.push(c);return{path:l.concat(i.reverse()),lca:b}}function p(g){let a={},u=0;function o(l){let i=u;g.children(l).forEach(o),a[l]={low:i,lim:u++}}return g.children().forEach(o),a}},{}],21:[function(t,r,h){"use strict";let x=t("@dagrejs/graphlib").Graph,d=t("../util");r.exports={positionX:w,findType1Conflicts:p,findType2Conflicts:g,addConflict:u,hasConflict:o,verticalAlignment:l,horizontalCompaction:i,alignCoordinates:c,findSmallestWidthAlignment:f,balance:b};function p(y,v){let k={};function M(I,Y){let T=0,D=0,$=I.length,C=Y[Y.length-1];return Y.forEach((O,S)=>{let R=a(y,O),j=R?y.node(R).order:$;(R||O===C)&&(Y.slice(D,S+1).forEach(W=>{y.predecessors(W).forEach(F=>{let ee=y.node(F),re=ee.order;(re<T||j<re)&&!(ee.dummy&&y.node(W).dummy)&&u(k,F,W)})}),D=S+1,T=j)}),Y}return v.length&&v.reduce(M),k}function g(y,v){let k={};function M(Y,T,D,$,C){let O;d.range(T,D).forEach(S=>{O=Y[S],y.node(O).dummy&&y.predecessors(O).forEach(R=>{let j=y.node(R);j.dummy&&(j.order<$||j.order>C)&&u(k,R,O)})})}function I(Y,T){let D=-1,$,C=0;return T.forEach((O,S)=>{if(y.node(O).dummy==="border"){let R=y.predecessors(O);R.length&&($=y.node(R[0]).order,M(T,C,S,D,$),C=S,D=$)}M(T,C,T.length,$,Y.length)}),T}return v.length&&v.reduce(I),k}function a(y,v){if(y.node(v).dummy)return y.predecessors(v).find(k=>y.node(k).dummy)}function u(y,v,k){if(v>k){let I=v;v=k,k=I}let M=y[v];M||(y[v]=M={}),M[k]=!0}function o(y,v,k){if(v>k){let M=v;v=k,k=M}return!!y[v]&&Object.hasOwn(y[v],k)}function l(y,v,k,M){let I={},Y={},T={};return v.forEach(D=>{D.forEach(($,C)=>{I[$]=$,Y[$]=$,T[$]=C})}),v.forEach(D=>{let $=-1;D.forEach(C=>{let O=M(C);if(O.length){O=O.sort((R,j)=>T[R]-T[j]);let S=(O.length-1)/2;for(let R=Math.floor(S),j=Math.ceil(S);R<=j;++R){let W=O[R];Y[C]===C&&$<T[W]&&!o(k,C,W)&&(Y[W]=C,Y[C]=I[C]=I[W],$=T[W])}}})}),{root:I,align:Y}}function i(y,v,k,M,I){let Y={},T=m(y,v,k,I),D=I?"borderLeft":"borderRight";function $(S,R){let j=T.nodes(),W=j.pop(),F={};for(;W;)F[W]?S(W):(F[W]=!0,j.push(W),j=j.concat(R(W))),W=j.pop()}function C(S){Y[S]=T.inEdges(S).reduce((R,j)=>Math.max(R,Y[j.v]+T.edge(j)),0)}function O(S){let R=T.outEdges(S).reduce((W,F)=>Math.min(W,Y[F.w]-T.edge(F)),Number.POSITIVE_INFINITY),j=y.node(S);R!==Number.POSITIVE_INFINITY&&j.borderType!==D&&(Y[S]=Math.max(Y[S],R))}return $(C,T.predecessors.bind(T)),$(O,T.successors.bind(T)),Object.keys(M).forEach(S=>Y[S]=Y[k[S]]),Y}function m(y,v,k,M){let I=new x,Y=y.graph(),T=E(Y.nodesep,Y.edgesep,M);return v.forEach(D=>{let $;D.forEach(C=>{let O=k[C];if(I.setNode(O),$){var S=k[$],R=I.edge(S,O);I.setEdge(S,O,Math.max(T(y,C,$),R||0))}$=C})}),I}function f(y,v){return Object.values(v).reduce((k,M)=>{let I=Number.NEGATIVE_INFINITY,Y=Number.POSITIVE_INFINITY;Object.entries(M).forEach(([D,$])=>{let C=L(y,D)/2;I=Math.max($+C,I),Y=Math.min($-C,Y)});let T=I-Y;return T<k[0]&&(k=[T,M]),k},[Number.POSITIVE_INFINITY,null])[1]}function c(y,v){let k=Object.values(v),M=d.applyWithChunking(Math.min,k),I=d.applyWithChunking(Math.max,k);["u","d"].forEach(Y=>{["l","r"].forEach(T=>{let D=Y+T,$=y[D];if($===v)return;let C=Object.values($),O=M-d.applyWithChunking(Math.min,C);T!=="l"&&(O=I-d.applyWithChunking(Math.max,C)),O&&(y[D]=d.mapValues($,S=>S+O))})})}function b(y,v){return d.mapValues(y.ul,(k,M)=>{if(v)return y[v.toLowerCase()][M];{let I=Object.values(y).map(Y=>Y[M]).sort((Y,T)=>Y-T);return(I[1]+I[2])/2}})}function w(y){let v=d.buildLayerMatrix(y),k=Object.assign(p(y,v),g(y,v)),M={},I;["u","d"].forEach(T=>{I=T==="u"?v:Object.values(v).reverse(),["l","r"].forEach(D=>{D==="r"&&(I=I.map(S=>Object.values(S).reverse()));let $=(T==="u"?y.predecessors:y.successors).bind(y),C=l(y,I,k,$),O=i(y,I,C.root,C.align,D==="r");D==="r"&&(O=d.mapValues(O,S=>-S)),M[T+D]=O})});let Y=f(y,M);return c(M,Y),b(M,y.graph().align)}function E(y,v,k){return(M,I,Y)=>{let T=M.node(I),D=M.node(Y),$=0,C;if($+=T.width/2,Object.hasOwn(T,"labelpos"))switch(T.labelpos.toLowerCase()){case"l":C=-T.width/2;break;case"r":C=T.width/2;break}if(C&&($+=k?C:-C),C=0,$+=(T.dummy?v:y)/2,$+=(D.dummy?v:y)/2,$+=D.width/2,Object.hasOwn(D,"labelpos"))switch(D.labelpos.toLowerCase()){case"l":C=D.width/2;break;case"r":C=-D.width/2;break}return C&&($+=k?C:-C),C=0,$}}function L(y,v){return y.node(v).width}},{"../util":27,"@dagrejs/graphlib":29}],22:[function(t,r,h){"use strict";let x=t("../util"),d=t("./bk").positionX;r.exports=p;function p(a){a=x.asNonCompoundGraph(a),g(a),Object.entries(d(a)).forEach(([u,o])=>a.node(u).x=o)}function g(a){let u=x.buildLayerMatrix(a),o=a.graph().ranksep,l=0;u.forEach(i=>{let m=i.reduce((f,c)=>{let b=a.node(c).height;return f>b?f:b},0);i.forEach(f=>a.node(f).y=l+m/2),l+=m+o})}},{"../util":27,"./bk":21}],23:[function(t,r,h){"use strict";var x=t("@dagrejs/graphlib").Graph,d=t("./util").slack;r.exports=p;function p(o){var l=new x({directed:!1}),i=o.nodes()[0],m=o.nodeCount();l.setNode(i,{});for(var f,c;g(l,o)<m;)f=a(l,o),c=l.hasNode(f.v)?d(o,f):-d(o,f),u(l,o,c);return l}function g(o,l){function i(m){l.nodeEdges(m).forEach(f=>{var c=f.v,b=m===c?f.w:c;!o.hasNode(b)&&!d(l,f)&&(o.setNode(b,{}),o.setEdge(m,b,{}),i(b))})}return o.nodes().forEach(i),o.nodeCount()}function a(o,l){return l.edges().reduce((m,f)=>{let c=Number.POSITIVE_INFINITY;return o.hasNode(f.v)!==o.hasNode(f.w)&&(c=d(l,f)),c<m[0]?[c,f]:m},[Number.POSITIVE_INFINITY,null])[1]}function u(o,l,i){o.nodes().forEach(m=>l.node(m).rank+=i)}},{"./util":26,"@dagrejs/graphlib":29}],24:[function(t,r,h){"use strict";var x=t("./util"),d=x.longestPath,p=t("./feasible-tree"),g=t("./network-simplex");r.exports=a;function a(i){var m=i.graph().ranker;if(m instanceof Function)return m(i);switch(i.graph().ranker){case"network-simplex":l(i);break;case"tight-tree":o(i);break;case"longest-path":u(i);break;case"none":break;default:l(i)}}var u=d;function o(i){d(i),p(i)}function l(i){g(i)}},{"./feasible-tree":23,"./network-simplex":25,"./util":26}],25:[function(t,r,h){"use strict";var x=t("./feasible-tree"),d=t("./util").slack,p=t("./util").longestPath,g=t("@dagrejs/graphlib").alg.preorder,a=t("@dagrejs/graphlib").alg.postorder,u=t("../util").simplify;r.exports=o,o.initLowLimValues=f,o.initCutValues=l,o.calcCutValue=m,o.leaveEdge=b,o.enterEdge=w,o.exchangeEdges=E;function o(k){k=u(k),p(k);var M=x(k);f(M),l(M,k);for(var I,Y;I=b(M);)Y=w(M,k,I),E(M,k,I,Y)}function l(k,M){var I=a(k,k.nodes());I=I.slice(0,I.length-1),I.forEach(Y=>i(k,M,Y))}function i(k,M,I){var Y=k.node(I),T=Y.parent;k.edge(I,T).cutvalue=m(k,M,I)}function m(k,M,I){var Y=k.node(I),T=Y.parent,D=!0,$=M.edge(I,T),C=0;return $||(D=!1,$=M.edge(T,I)),C=$.weight,M.nodeEdges(I).forEach(O=>{var S=O.v===I,R=S?O.w:O.v;if(R!==T){var j=S===D,W=M.edge(O).weight;if(C+=j?W:-W,y(k,I,R)){var F=k.edge(I,R).cutvalue;C+=j?-F:F}}}),C}function f(k,M){arguments.length<2&&(M=k.nodes()[0]),c(k,{},1,M)}function c(k,M,I,Y,T){var D=I,$=k.node(Y);return M[Y]=!0,k.neighbors(Y).forEach(C=>{Object.hasOwn(M,C)||(I=c(k,M,I,C,Y))}),$.low=D,$.lim=I++,T?$.parent=T:delete $.parent,I}function b(k){return k.edges().find(M=>k.edge(M).cutvalue<0)}function w(k,M,I){var Y=I.v,T=I.w;M.hasEdge(Y,T)||(Y=I.w,T=I.v);var D=k.node(Y),$=k.node(T),C=D,O=!1;D.lim>$.lim&&(C=$,O=!0);var S=M.edges().filter(R=>O===v(k,k.node(R.v),C)&&O!==v(k,k.node(R.w),C));return S.reduce((R,j)=>d(M,j)<d(M,R)?j:R)}function E(k,M,I,Y){var T=I.v,D=I.w;k.removeEdge(T,D),k.setEdge(Y.v,Y.w,{}),f(k),l(k,M),L(k,M)}function L(k,M){var I=k.nodes().find(T=>!M.node(T).parent),Y=g(k,I);Y=Y.slice(1),Y.forEach(T=>{var D=k.node(T).parent,$=M.edge(T,D),C=!1;$||($=M.edge(D,T),C=!0),M.node(T).rank=M.node(D).rank+(C?$.minlen:-$.minlen)})}function y(k,M,I){return k.hasEdge(M,I)}function v(k,M,I){return I.low<=M.lim&&M.lim<=I.lim}},{"../util":27,"./feasible-tree":23,"./util":26,"@dagrejs/graphlib":29}],26:[function(t,r,h){"use strict";let{applyWithChunking:x}=t("../util");r.exports={longestPath:d,slack:p};function d(g){var a={};function u(o){var l=g.node(o);if(Object.hasOwn(a,o))return l.rank;a[o]=!0;let i=g.outEdges(o).map(f=>f==null?Number.POSITIVE_INFINITY:u(f.w)-g.edge(f).minlen);var m=x(Math.min,i);return m===Number.POSITIVE_INFINITY&&(m=0),l.rank=m}g.sources().forEach(u)}function p(g,a){return g.node(a.w).rank-g.node(a.v).rank-g.edge(a).minlen}},{"../util":27}],27:[function(t,r,h){"use strict";let x=t("@dagrejs/graphlib").Graph;r.exports={addBorderNode:f,addDummyNode:d,applyWithChunking:w,asNonCompoundGraph:g,buildLayerMatrix:l,intersectRect:o,mapValues:T,maxRank:E,normalizeRanks:i,notime:v,partition:L,pick:Y,predecessorWeights:u,range:I,removeEmptyRanks:m,simplify:p,successorWeights:a,time:y,uniqueId:M,zipObject:D};function d($,C,O,S){for(var R=S;$.hasNode(R);)R=M(S);return O.dummy=C,$.setNode(R,O),R}function p($){let C=new x().setGraph($.graph());return $.nodes().forEach(O=>C.setNode(O,$.node(O))),$.edges().forEach(O=>{let S=C.edge(O.v,O.w)||{weight:0,minlen:1},R=$.edge(O);C.setEdge(O.v,O.w,{weight:S.weight+R.weight,minlen:Math.max(S.minlen,R.minlen)})}),C}function g($){let C=new x({multigraph:$.isMultigraph()}).setGraph($.graph());return $.nodes().forEach(O=>{$.children(O).length||C.setNode(O,$.node(O))}),$.edges().forEach(O=>{C.setEdge(O,$.edge(O))}),C}function a($){let C=$.nodes().map(O=>{let S={};return $.outEdges(O).forEach(R=>{S[R.w]=(S[R.w]||0)+$.edge(R).weight}),S});return D($.nodes(),C)}function u($){let C=$.nodes().map(O=>{let S={};return $.inEdges(O).forEach(R=>{S[R.v]=(S[R.v]||0)+$.edge(R).weight}),S});return D($.nodes(),C)}function o($,C){let O=$.x,S=$.y,R=C.x-O,j=C.y-S,W=$.width/2,F=$.height/2;if(!R&&!j)throw new Error("Not possible to find intersection inside of the rectangle");let ee,re;return Math.abs(j)*W>Math.abs(R)*F?(j<0&&(F=-F),ee=F*R/j,re=F):(R<0&&(W=-W),ee=W,re=W*j/R),{x:O+ee,y:S+re}}function l($){let C=I(E($)+1).map(()=>[]);return $.nodes().forEach(O=>{let S=$.node(O),R=S.rank;R!==void 0&&(C[R][S.order]=O)}),C}function i($){let C=$.nodes().map(S=>{let R=$.node(S).rank;return R===void 0?Number.MAX_VALUE:R}),O=w(Math.min,C);$.nodes().forEach(S=>{let R=$.node(S);Object.hasOwn(R,"rank")&&(R.rank-=O)})}function m($){let C=$.nodes().map(W=>$.node(W).rank),O=w(Math.min,C),S=[];$.nodes().forEach(W=>{let F=$.node(W).rank-O;S[F]||(S[F]=[]),S[F].push(W)});let R=0,j=$.graph().nodeRankFactor;Array.from(S).forEach((W,F)=>{W===void 0&&F%j!==0?--R:W!==void 0&&R&&W.forEach(ee=>$.node(ee).rank+=R)})}function f($,C,O,S){let R={width:0,height:0};return arguments.length>=4&&(R.rank=O,R.order=S),d($,"border",R,C)}function c($,C=b){let O=[];for(let S=0;S<$.length;S+=C){let R=$.slice(S,S+C);O.push(R)}return O}let b=65535;function w($,C){if(C.length>b){let O=c(C);return $.apply(null,O.map(S=>$.apply(null,S)))}else return $.apply(null,C)}function E($){let O=$.nodes().map(S=>{let R=$.node(S).rank;return R===void 0?Number.MIN_VALUE:R});return w(Math.max,O)}function L($,C){let O={lhs:[],rhs:[]};return $.forEach(S=>{C(S)?O.lhs.push(S):O.rhs.push(S)}),O}function y($,C){let O=Date.now();try{return C()}finally{console.log($+" time: "+(Date.now()-O)+"ms")}}function v($,C){return C()}let k=0;function M($){var C=++k;return $+(""+C)}function I($,C,O=1){C==null&&(C=$,$=0);let S=j=>j<C;O<0&&(S=j=>C<j);let R=[];for(let j=$;S(j);j+=O)R.push(j);return R}function Y($,C){let O={};for(let S of C)$[S]!==void 0&&(O[S]=$[S]);return O}function T($,C){let O=C;return typeof C=="string"&&(O=S=>S[C]),Object.entries($).reduce((S,[R,j])=>(S[R]=O(j,R),S),{})}function D($,C){return $.reduce((O,S,R)=>(O[S]=C[R],O),{})}},{"@dagrejs/graphlib":29}],28:[function(t,r,h){r.exports="1.1.8"},{}],29:[function(t,r,h){var x=t("./lib");r.exports={Graph:x.Graph,json:t("./lib/json"),alg:t("./lib/alg"),version:x.version}},{"./lib":45,"./lib/alg":36,"./lib/json":46}],30:[function(t,r,h){r.exports=x;function x(d){var p={},g=[],a;function u(o){Object.hasOwn(p,o)||(p[o]=!0,a.push(o),d.successors(o).forEach(u),d.predecessors(o).forEach(u))}return d.nodes().forEach(function(o){a=[],u(o),a.length&&g.push(a)}),g}},{}],31:[function(t,r,h){r.exports=x;function x(a,u,o){Array.isArray(u)||(u=[u]);var l=a.isDirected()?c=>a.successors(c):c=>a.neighbors(c),i=o==="post"?d:p,m=[],f={};return u.forEach(c=>{if(!a.hasNode(c))throw new Error("Graph does not have node: "+c);i(c,l,f,m)}),m}function d(a,u,o,l){for(var i=[[a,!1]];i.length>0;){var m=i.pop();m[1]?l.push(m[0]):Object.hasOwn(o,m[0])||(o[m[0]]=!0,i.push([m[0],!0]),g(u(m[0]),f=>i.push([f,!1])))}}function p(a,u,o,l){for(var i=[a];i.length>0;){var m=i.pop();Object.hasOwn(o,m)||(o[m]=!0,l.push(m),g(u(m),f=>i.push(f)))}}function g(a,u){for(var o=a.length;o--;)u(a[o],o,a);return a}},{}],32:[function(t,r,h){var x=t("./dijkstra");r.exports=d;function d(p,g,a){return p.nodes().reduce(function(u,o){return u[o]=x(p,o,g,a),u},{})}},{"./dijkstra":33}],33:[function(t,r,h){var x=t("../data/priority-queue");r.exports=p;var d=()=>1;function p(a,u,o,l){return g(a,String(u),o||d,l||function(i){return a.outEdges(i)})}function g(a,u,o,l){var i={},m=new x,f,c,b=function(w){var E=w.v!==f?w.v:w.w,L=i[E],y=o(w),v=c.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+w+" Weight: "+y);v<L.distance&&(L.distance=v,L.predecessor=f,m.decrease(E,v))};for(a.nodes().forEach(function(w){var E=w===u?0:Number.POSITIVE_INFINITY;i[w]={distance:E},m.add(w,E)});m.size()>0&&(f=m.removeMin(),c=i[f],c.distance!==Number.POSITIVE_INFINITY);)l(f).forEach(b);return i}},{"../data/priority-queue":43}],34:[function(t,r,h){var x=t("./tarjan");r.exports=d;function d(p){return x(p).filter(function(g){return g.length>1||g.length===1&&p.hasEdge(g[0],g[0])})}},{"./tarjan":41}],35:[function(t,r,h){r.exports=d;var x=()=>1;function d(g,a,u){return p(g,a||x,u||function(o){return g.outEdges(o)})}function p(g,a,u){var o={},l=g.nodes();return l.forEach(function(i){o[i]={},o[i][i]={distance:0},l.forEach(function(m){i!==m&&(o[i][m]={distance:Number.POSITIVE_INFINITY})}),u(i).forEach(function(m){var f=m.v===i?m.w:m.v,c=a(m);o[i][f]={distance:c,predecessor:i}})}),l.forEach(function(i){var m=o[i];l.forEach(function(f){var c=o[f];l.forEach(function(b){var w=c[i],E=m[b],L=c[b],y=w.distance+E.distance;y<L.distance&&(L.distance=y,L.predecessor=E.predecessor)})})}),o}},{}],36:[function(t,r,h){r.exports={components:t("./components"),dijkstra:t("./dijkstra"),dijkstraAll:t("./dijkstra-all"),findCycles:t("./find-cycles"),floydWarshall:t("./floyd-warshall"),isAcyclic:t("./is-acyclic"),postorder:t("./postorder"),preorder:t("./preorder"),prim:t("./prim"),tarjan:t("./tarjan"),topsort:t("./topsort")}},{"./components":30,"./dijkstra":33,"./dijkstra-all":32,"./find-cycles":34,"./floyd-warshall":35,"./is-acyclic":37,"./postorder":38,"./preorder":39,"./prim":40,"./tarjan":41,"./topsort":42}],37:[function(t,r,h){var x=t("./topsort");r.exports=d;function d(p){try{x(p)}catch(g){if(g instanceof x.CycleException)return!1;throw g}return!0}},{"./topsort":42}],38:[function(t,r,h){var x=t("./dfs");r.exports=d;function d(p,g){return x(p,g,"post")}},{"./dfs":31}],39:[function(t,r,h){var x=t("./dfs");r.exports=d;function d(p,g){return x(p,g,"pre")}},{"./dfs":31}],40:[function(t,r,h){var x=t("../graph"),d=t("../data/priority-queue");r.exports=p;function p(g,a){var u=new x,o={},l=new d,i;function m(c){var b=c.v===i?c.w:c.v,w=l.priority(b);if(w!==void 0){var E=a(c);E<w&&(o[b]=i,l.decrease(b,E))}}if(g.nodeCount()===0)return u;g.nodes().forEach(function(c){l.add(c,Number.POSITIVE_INFINITY),u.setNode(c)}),l.decrease(g.nodes()[0],0);for(var f=!1;l.size()>0;){if(i=l.removeMin(),Object.hasOwn(o,i))u.setEdge(i,o[i]);else{if(f)throw new Error("Input graph is not connected: "+g);f=!0}g.nodeEdges(i).forEach(m)}return u}},{"../data/priority-queue":43,"../graph":44}],41:[function(t,r,h){r.exports=x;function x(d){var p=0,g=[],a={},u=[];function o(l){var i=a[l]={onStack:!0,lowlink:p,index:p++};if(g.push(l),d.successors(l).forEach(function(c){Object.hasOwn(a,c)?a[c].onStack&&(i.lowlink=Math.min(i.lowlink,a[c].index)):(o(c),i.lowlink=Math.min(i.lowlink,a[c].lowlink))}),i.lowlink===i.index){var m=[],f;do f=g.pop(),a[f].onStack=!1,m.push(f);while(l!==f);u.push(m)}}return d.nodes().forEach(function(l){Object.hasOwn(a,l)||o(l)}),u}},{}],42:[function(t,r,h){function x(p){var g={},a={},u=[];function o(l){if(Object.hasOwn(a,l))throw new d;Object.hasOwn(g,l)||(a[l]=!0,g[l]=!0,p.predecessors(l).forEach(o),delete a[l],u.push(l))}if(p.sinks().forEach(o),Object.keys(g).length!==p.nodeCount())throw new d;return u}class d extends Error{constructor(){super(...arguments)}}r.exports=x,x.CycleException=d},{}],43:[function(t,r,h){class x{constructor(){J(this,"_arr",[]);J(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(p){return p.key})}has(p){return Object.hasOwn(this._keyIndices,p)}priority(p){var g=this._keyIndices[p];if(g!==void 0)return this._arr[g].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(p,g){var a=this._keyIndices;if(p=String(p),!Object.hasOwn(a,p)){var u=this._arr,o=u.length;return a[p]=o,u.push({key:p,priority:g}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var p=this._arr.pop();return delete this._keyIndices[p.key],this._heapify(0),p.key}decrease(p,g){var a=this._keyIndices[p];if(g>this._arr[a].priority)throw new Error("New priority is greater than current priority. Key: "+p+" Old: "+this._arr[a].priority+" New: "+g);this._arr[a].priority=g,this._decrease(a)}_heapify(p){var g=this._arr,a=2*p,u=a+1,o=p;a<g.length&&(o=g[a].priority<g[o].priority?a:o,u<g.length&&(o=g[u].priority<g[o].priority?u:o),o!==p&&(this._swap(p,o),this._heapify(o)))}_decrease(p){for(var g=this._arr,a=g[p].priority,u;p!==0&&(u=p>>1,!(g[u].priority<a));)this._swap(p,u),p=u}_swap(p,g){var a=this._arr,u=this._keyIndices,o=a[p],l=a[g];a[p]=l,a[g]=o,u[l.key]=p,u[o.key]=g}}r.exports=x},{}],44:[function(t,r,h){"use strict";var x="\0",d="\0",p="";class g{constructor(f){J(this,"_isDirected",!0);J(this,"_isMultigraph",!1);J(this,"_isCompound",!1);J(this,"_label");J(this,"_defaultNodeLabelFn",()=>{});J(this,"_defaultEdgeLabelFn",()=>{});J(this,"_nodes",{});J(this,"_in",{});J(this,"_preds",{});J(this,"_out",{});J(this,"_sucs",{});J(this,"_edgeObjs",{});J(this,"_edgeLabels",{});J(this,"_nodeCount",0);J(this,"_edgeCount",0);J(this,"_parent");J(this,"_children");f&&(this._isDirected=Object.hasOwn(f,"directed")?f.directed:!0,this._isMultigraph=Object.hasOwn(f,"multigraph")?f.multigraph:!1,this._isCompound=Object.hasOwn(f,"compound")?f.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[d]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(f){return this._label=f,this}graph(){return this._label}setDefaultNodeLabel(f){return this._defaultNodeLabelFn=f,typeof f!="function"&&(this._defaultNodeLabelFn=()=>f),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var f=this;return this.nodes().filter(c=>Object.keys(f._in[c]).length===0)}sinks(){var f=this;return this.nodes().filter(c=>Object.keys(f._out[c]).length===0)}setNodes(f,c){var b=arguments,w=this;return f.forEach(function(E){b.length>1?w.setNode(E,c):w.setNode(E)}),this}setNode(f,c){return Object.hasOwn(this._nodes,f)?(arguments.length>1&&(this._nodes[f]=c),this):(this._nodes[f]=arguments.length>1?c:this._defaultNodeLabelFn(f),this._isCompound&&(this._parent[f]=d,this._children[f]={},this._children[d][f]=!0),this._in[f]={},this._preds[f]={},this._out[f]={},this._sucs[f]={},++this._nodeCount,this)}node(f){return this._nodes[f]}hasNode(f){return Object.hasOwn(this._nodes,f)}removeNode(f){var c=this;if(Object.hasOwn(this._nodes,f)){var b=w=>c.removeEdge(c._edgeObjs[w]);delete this._nodes[f],this._isCompound&&(this._removeFromParentsChildList(f),delete this._parent[f],this.children(f).forEach(function(w){c.setParent(w)}),delete this._children[f]),Object.keys(this._in[f]).forEach(b),delete this._in[f],delete this._preds[f],Object.keys(this._out[f]).forEach(b),delete this._out[f],delete this._sucs[f],--this._nodeCount}return this}setParent(f,c){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(c===void 0)c=d;else{c+="";for(var b=c;b!==void 0;b=this.parent(b))if(b===f)throw new Error("Setting "+c+" as parent of "+f+" would create a cycle");this.setNode(c)}return this.setNode(f),this._removeFromParentsChildList(f),this._parent[f]=c,this._children[c][f]=!0,this}_removeFromParentsChildList(f){delete this._children[this._parent[f]][f]}parent(f){if(this._isCompound){var c=this._parent[f];if(c!==d)return c}}children(f=d){if(this._isCompound){var c=this._children[f];if(c)return Object.keys(c)}else{if(f===d)return this.nodes();if(this.hasNode(f))return[]}}predecessors(f){var c=this._preds[f];if(c)return Object.keys(c)}successors(f){var c=this._sucs[f];if(c)return Object.keys(c)}neighbors(f){var c=this.predecessors(f);if(c){let w=new Set(c);for(var b of this.successors(f))w.add(b);return Array.from(w.values())}}isLeaf(f){var c;return this.isDirected()?c=this.successors(f):c=this.neighbors(f),c.length===0}filterNodes(f){var c=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});c.setGraph(this.graph());var b=this;Object.entries(this._nodes).forEach(function([L,y]){f(L)&&c.setNode(L,y)}),Object.values(this._edgeObjs).forEach(function(L){c.hasNode(L.v)&&c.hasNode(L.w)&&c.setEdge(L,b.edge(L))});var w={};function E(L){var y=b.parent(L);return y===void 0||c.hasNode(y)?(w[L]=y,y):y in w?w[y]:E(y)}return this._isCompound&&c.nodes().forEach(L=>c.setParent(L,E(L))),c}setDefaultEdgeLabel(f){return this._defaultEdgeLabelFn=f,typeof f!="function"&&(this._defaultEdgeLabelFn=()=>f),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(f,c){var b=this,w=arguments;return f.reduce(function(E,L){return w.length>1?b.setEdge(E,L,c):b.setEdge(E,L),L}),this}setEdge(){var f,c,b,w,E=!1,L=arguments[0];typeof L=="object"&&L!==null&&"v"in L?(f=L.v,c=L.w,b=L.name,arguments.length===2&&(w=arguments[1],E=!0)):(f=L,c=arguments[1],b=arguments[3],arguments.length>2&&(w=arguments[2],E=!0)),f=""+f,c=""+c,b!==void 0&&(b=""+b);var y=o(this._isDirected,f,c,b);if(Object.hasOwn(this._edgeLabels,y))return E&&(this._edgeLabels[y]=w),this;if(b!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(f),this.setNode(c),this._edgeLabels[y]=E?w:this._defaultEdgeLabelFn(f,c,b);var v=l(this._isDirected,f,c,b);return f=v.v,c=v.w,Object.freeze(v),this._edgeObjs[y]=v,a(this._preds[c],f),a(this._sucs[f],c),this._in[c][y]=v,this._out[f][y]=v,this._edgeCount++,this}edge(f,c,b){var w=arguments.length===1?i(this._isDirected,arguments[0]):o(this._isDirected,f,c,b);return this._edgeLabels[w]}edgeAsObj(){let f=this.edge(...arguments);return typeof f!="object"?{label:f}:f}hasEdge(f,c,b){var w=arguments.length===1?i(this._isDirected,arguments[0]):o(this._isDirected,f,c,b);return Object.hasOwn(this._edgeLabels,w)}removeEdge(f,c,b){var w=arguments.length===1?i(this._isDirected,arguments[0]):o(this._isDirected,f,c,b),E=this._edgeObjs[w];return E&&(f=E.v,c=E.w,delete this._edgeLabels[w],delete this._edgeObjs[w],u(this._preds[c],f),u(this._sucs[f],c),delete this._in[c][w],delete this._out[f][w],this._edgeCount--),this}inEdges(f,c){var b=this._in[f];if(b){var w=Object.values(b);return c?w.filter(E=>E.v===c):w}}outEdges(f,c){var b=this._out[f];if(b){var w=Object.values(b);return c?w.filter(E=>E.w===c):w}}nodeEdges(f,c){var b=this.inEdges(f,c);if(b)return b.concat(this.outEdges(f,c))}}function a(m,f){m[f]?m[f]++:m[f]=1}function u(m,f){--m[f]||delete m[f]}function o(m,f,c,b){var w=""+f,E=""+c;if(!m&&w>E){var L=w;w=E,E=L}return w+p+E+p+(b===void 0?x:b)}function l(m,f,c,b){var w=""+f,E=""+c;if(!m&&w>E){var L=w;w=E,E=L}var y={v:w,w:E};return b&&(y.name=b),y}function i(m,f){return o(m,f.v,f.w,f.name)}r.exports=g},{}],45:[function(t,r,h){r.exports={Graph:t("./graph"),version:t("./version")}},{"./graph":44,"./version":47}],46:[function(t,r,h){var x=t("./graph");r.exports={write:d,read:a};function d(u){var o={options:{directed:u.isDirected(),multigraph:u.isMultigraph(),compound:u.isCompound()},nodes:p(u),edges:g(u)};return u.graph()!==void 0&&(o.value=structuredClone(u.graph())),o}function p(u){return u.nodes().map(function(o){var l=u.node(o),i=u.parent(o),m={v:o};return l!==void 0&&(m.value=l),i!==void 0&&(m.parent=i),m})}function g(u){return u.edges().map(function(o){var l=u.edge(o),i={v:o.v,w:o.w};return o.name!==void 0&&(i.name=o.name),l!==void 0&&(i.value=l),i})}function a(u){var o=new x(u.options).setGraph(u.value);return u.nodes.forEach(function(l){o.setNode(l.v,l.value),l.parent&&o.setParent(l.v,l.parent)}),u.edges.forEach(function(l){o.setEdge({v:l.v,w:l.w,name:l.name},l.value)}),o}},{"./graph":44}],47:[function(t,r,h){r.exports="2.2.4"},{}]},{},[1])(1)})});var ae=Mt(Ve(),1);var ve={bg:"#FFFFFF",fg:"#27272A"},se={textSec:60,textMuted:40,textFaint:25,line:30,arrow:50,nodeFill:3,nodeStroke:20,groupHeader:5,innerStroke:12,keyBadge:10},it={"zinc-dark":{bg:"#18181B",fg:"#FAFAFA"},"tokyo-night":{bg:"#1a1b26",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-storm":{bg:"#24283b",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-light":{bg:"#d5d6db",fg:"#343b58",line:"#34548a",accent:"#34548a",muted:"#9699a3"},"catppuccin-mocha":{bg:"#1e1e2e",fg:"#cdd6f4",line:"#585b70",accent:"#cba6f7",muted:"#6c7086"},"catppuccin-latte":{bg:"#eff1f5",fg:"#4c4f69",line:"#9ca0b0",accent:"#8839ef",muted:"#9ca0b0"},nord:{bg:"#2e3440",fg:"#d8dee9",line:"#4c566a",accent:"#88c0d0",muted:"#616e88"},"nord-light":{bg:"#eceff4",fg:"#2e3440",line:"#aab1c0",accent:"#5e81ac",muted:"#7b88a1"},dracula:{bg:"#282a36",fg:"#f8f8f2",line:"#6272a4",accent:"#bd93f9",muted:"#6272a4"},"github-light":{bg:"#ffffff",fg:"#1f2328",line:"#d1d9e0",accent:"#0969da",muted:"#59636e"},"github-dark":{bg:"#0d1117",fg:"#e6edf3",line:"#3d444d",accent:"#4493f8",muted:"#9198a1"},"solarized-light":{bg:"#fdf6e3",fg:"#657b83",line:"#93a1a1",accent:"#268bd2",muted:"#93a1a1"},"solarized-dark":{bg:"#002b36",fg:"#839496",line:"#586e75",accent:"#268bd2",muted:"#586e75"},"one-dark":{bg:"#282c34",fg:"#abb2bf",line:"#4b5263",accent:"#c678dd",muted:"#5c6370"}};function Se(e,n){let s=[`@import url('https://fonts.googleapis.com/css2?family=${encodeURIComponent(e)}:wght@400;500;600;700&amp;display=swap');`,...n?["@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;display=swap');"]:[]],t=`
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) ${se.textSec}%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) ${se.textMuted}%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) ${se.textFaint}%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) ${se.line}%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) ${se.arrow}%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) ${se.nodeFill}%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) ${se.nodeStroke}%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) ${se.groupHeader}%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) ${se.innerStroke}%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) ${se.keyBadge}%, var(--bg));`;return["<style>",`  ${s.join(`
  `)}`,`  text { font-family: '${e}', system-ui, sans-serif; }`,...n?["  .mono { font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', ui-monospace, monospace; }"]:[],`  svg {${t}`,"  }","</style>"].join(`
`)}function Ie(e,n,s,t){let r=[`--bg:${s.bg}`,`--fg:${s.fg}`,s.line?`--line:${s.line}`:"",s.accent?`--accent:${s.accent}`:"",s.muted?`--muted:${s.muted}`:"",s.surface?`--surface:${s.surface}`:"",s.border?`--border:${s.border}`:""].filter(Boolean).join(";");return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${n}" width="${e}" height="${n}" style="${r}${t?"":";background:var(--bg)"}">`}function _t(e){let n=e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0&&!t.startsWith("%%"));if(n.length===0)throw new Error("Empty mermaid diagram");let s=n[0];return/^stateDiagram(-v2)?\s*$/i.test(s)?St(n):Lt(n)}function Lt(e){let n=e[0].match(/^(?:graph|flowchart)\s+(TD|TB|LR|BT|RL)\s*$/i);if(!n)throw new Error(`Invalid mermaid header: "${e[0]}". Expected "graph TD", "flowchart LR", "stateDiagram-v2", etc.`);let t={direction:n[1].toUpperCase(),nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},r=[];for(let h=1;h<e.length;h++){let x=e[h],d=x.match(/^classDef\s+(\w+)\s+(.+)$/);if(d){let o=d[1],l=d[2],i=Je(l);t.classDefs.set(o,i);continue}let p=x.match(/^class\s+([\w,-]+)\s+(\w+)$/);if(p){let o=p[1].split(",").map(i=>i.trim()),l=p[2];for(let i of o)t.classAssignments.set(i,l);continue}let g=x.match(/^style\s+([\w,-]+)\s+(.+)$/);if(g){let o=g[1].split(",").map(i=>i.trim()),l=Je(g[2]);for(let i of o)t.nodeStyles.set(i,{...t.nodeStyles.get(i),...l});continue}let a=x.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(a&&r.length>0){r[r.length-1].direction=a[1].toUpperCase();continue}let u=x.match(/^subgraph\s+(.+)$/);if(u){let o=u[1].trim(),l=o.match(/^([\w-]+)\s*\[(.+)\]$/),i,m;l?(i=l[1],m=l[2]):(m=o,i=o.replace(/\s+/g,"_").replace(/[^\w]/g,""));let f={id:i,label:m,nodeIds:[],children:[]};r.push(f);continue}if(x==="end"){let o=r.pop();o&&(r.length>0?r[r.length-1].children.push(o):t.subgraphs.push(o));continue}Ht(x,t,r)}return t}function St(e){let n={direction:"TD",nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},s=[],t=0,r=0;for(let h=1;h<e.length;h++){let x=e[h],d=x.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(d){s.length>0?s[s.length-1].direction=d[1].toUpperCase():n.direction=d[1].toUpperCase();continue}let p=x.match(/^state\s+(?:"([^"]+)"\s+as\s+)?(\w+)\s*\{$/);if(p){let o=p[1]??p[2],i={id:p[2],label:o,nodeIds:[],children:[]};s.push(i);continue}if(x==="}"){let o=s.pop();o&&(s.length>0?s[s.length-1].children.push(o):n.subgraphs.push(o));continue}let g=x.match(/^state\s+"([^"]+)"\s+as\s+(\w+)\s*$/);if(g){let o=g[1],l=g[2];xe(n,s,{id:l,label:o,shape:"rounded"});continue}let a=x.match(/^(\[\*\]|[\w-]+)\s*(-->)\s*(\[\*\]|[\w-]+)(?:\s*:\s*(.+))?$/);if(a){let o=a[1],l=a[3],i=a[4]?.trim()||void 0;o==="[*]"?(t++,o=`_start${t>1?t:""}`,xe(n,s,{id:o,label:"",shape:"state-start"})):Ue(n,s,o),l==="[*]"?(r++,l=`_end${r>1?r:""}`,xe(n,s,{id:l,label:"",shape:"state-end"})):Ue(n,s,l),n.edges.push({source:o,target:l,label:i,style:"solid",hasArrowStart:!1,hasArrowEnd:!0});continue}let u=x.match(/^([\w-]+)\s*:\s*(.+)$/);if(u){let o=u[1],l=u[2].trim();xe(n,s,{id:o,label:l,shape:"rounded"});continue}}return n}function xe(e,n,s){if(!e.nodes.has(s.id)&&e.nodes.set(s.id,s),n.length>0){let r=n[n.length-1];r.nodeIds.includes(s.id)||r.nodeIds.push(s.id)}}function Ue(e,n,s){if(!e.nodes.has(s))xe(e,n,{id:s,label:s,shape:"rounded"});else if(n.length>0){let t=n[n.length-1];t.nodeIds.includes(s)||t.nodeIds.push(s)}}function Je(e){let n={};for(let s of e.split(",")){let t=s.indexOf(":");if(t>0){let r=s.slice(0,t).trim(),h=s.slice(t+1).trim();r&&h&&(n[r]=h)}}return n}var It=/^(<)?(-->|-.->|==>|---|-\.-|===)(?:\|([^|]*)\|)?/,Ot=[{regex:/^([\w-]+)\(\(\((.+?)\)\)\)/,shape:"doublecircle"},{regex:/^([\w-]+)\(\[(.+?)\]\)/,shape:"stadium"},{regex:/^([\w-]+)\(\((.+?)\)\)/,shape:"circle"},{regex:/^([\w-]+)\[\[(.+?)\]\]/,shape:"subroutine"},{regex:/^([\w-]+)\[\((.+?)\)\]/,shape:"cylinder"},{regex:/^([\w-]+)\[\/(.+?)\\\]/,shape:"trapezoid"},{regex:/^([\w-]+)\[\\(.+?)\/\]/,shape:"trapezoid-alt"},{regex:/^([\w-]+)>(.+?)\]/,shape:"asymmetric"},{regex:/^([\w-]+)\{\{(.+?)\}\}/,shape:"hexagon"},{regex:/^([\w-]+)\[(.+?)\]/,shape:"rectangle"},{regex:/^([\w-]+)\((.+?)\)/,shape:"rounded"},{regex:/^([\w-]+)\{(.+?)\}/,shape:"diamond"}],Tt=/^([\w-]+)/,Rt=/^:::([\w][\w-]*)/;function Ht(e,n,s){let t=e.trim(),r=Ke(t,n,s);if(!r||r.ids.length===0)return;t=r.remaining.trim();let h=r.ids;for(;t.length>0;){let x=t.match(It);if(!x)break;let d=!!x[1],p=x[2],g=x[3]?.trim()||void 0;t=t.slice(x[0].length).trim();let a=Yt(p),u=p.endsWith(">"),o=Ke(t,n,s);if(!o||o.ids.length===0)break;t=o.remaining.trim();for(let l of h)for(let i of o.ids)n.edges.push({source:l,target:i,label:g,style:a,hasArrowStart:d,hasArrowEnd:u});h=o.ids}}function Ke(e,n,s){let t=qe(e,n,s);if(!t)return null;let r=[t.id],h=t.remaining.trim();for(;h.startsWith("&");){h=h.slice(1).trim();let x=qe(h,n,s);if(!x)break;r.push(x.id),h=x.remaining.trim()}return{ids:r,remaining:h}}function qe(e,n,s){let t=null,r=e;for(let{regex:x,shape:d}of Ot){let p=e.match(x);if(p){t=p[1];let g=p[2];Qe(n,s,{id:t,label:g,shape:d}),r=e.slice(p[0].length);break}}if(t===null){let x=e.match(Tt);x&&(t=x[1],n.nodes.has(t)?at(s,t):Qe(n,s,{id:t,label:t,shape:"rectangle"}),r=e.slice(x[0].length))}if(t===null)return null;let h=r.match(Rt);return h&&(n.classAssignments.set(t,h[1]),r=r.slice(h[0].length)),{id:t,remaining:r}}function Qe(e,n,s){!e.nodes.has(s.id)&&e.nodes.set(s.id,s),at(n,s.id)}function at(e,n){if(e.length>0){let s=e[e.length-1];s.nodeIds.includes(n)||s.nodeIds.push(n)}}function Yt(e){return e==="-.->"||e==="-.-"?"dotted":e==="==>"||e==="==="?"thick":"solid"}function At(e){let n={actors:[],messages:[],blocks:[],notes:[]},s=new Set,t=[];for(let r=1;r<e.length;r++){let h=e[r],x=h.match(/^(participant|actor)\s+(\S+?)(?:\s+as\s+(.+))?$/);if(x){let o=x[1],l=x[2],i=x[3]?.trim()??l;s.has(l)||(s.add(l),n.actors.push({id:l,label:i,type:o}));continue}let d=h.match(/^Note\s+(left of|right of|over)\s+([^:]+):\s*(.+)$/i);if(d){let o=d[1].toLowerCase(),l=d[2].trim(),i=d[3].trim(),m=l.split(",").map(c=>c.trim());for(let c of m)ge(n,s,c);let f="over";o==="left of"?f="left":o==="right of"&&(f="right"),n.notes.push({actorIds:m,text:i,position:f,afterIndex:n.messages.length-1});continue}let p=h.match(/^(loop|alt|opt|par|critical|break|rect)\s*(.*)$/);if(p){let o=p[1],l=p[2]?.trim()??"";t.push({type:o,label:l,startIndex:n.messages.length,dividers:[]});continue}let g=h.match(/^(else|and)\s*(.*)$/);if(g&&t.length>0){let o=g[2]?.trim()??"";t[t.length-1].dividers.push({index:n.messages.length,label:o});continue}if(h==="end"&&t.length>0){let o=t.pop();n.blocks.push({type:o.type,label:o.label,startIndex:o.startIndex,endIndex:Math.max(n.messages.length-1,o.startIndex),dividers:o.dividers});continue}let a=h.match(/^(\S+?)\s*(--?>?>|--?[)x]|--?>>|--?>)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(a){let o=a[1],l=a[2],i=a[3],m=a[4],f=a[5].trim();ge(n,s,o),ge(n,s,m);let c=l.startsWith("--")?"dashed":"solid",b=l.includes(">>")||l.includes("x")?"filled":"open",w={from:o,to:m,label:f,lineStyle:c,arrowHead:b};i==="+"&&(w.activate=!0),i==="-"&&(w.deactivate=!0),n.messages.push(w);continue}let u=h.match(/^(\S+?)\s*(->>|-->>|-\)|--\)|-x|--x|->|-->)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(u){let o=u[1],l=u[2],i=u[3],m=u[4],f=u[5].trim();ge(n,s,o),ge(n,s,m);let c=l.startsWith("--")?"dashed":"solid",b=l.includes(">>")||l.includes("x")?"filled":"open",w={from:o,to:m,label:f,lineStyle:c,arrowHead:b};i==="+"&&(w.activate=!0),i==="-"&&(w.deactivate=!0),n.messages.push(w);continue}}return n}function ge(e,n,s){n.has(s)||(n.add(s),e.actors.push({id:s,label:s,type:"participant"}))}function Dt(e){let n={classes:[],relationships:[],namespaces:[]},s=new Map,t=null,r=null,h=0;for(let x=1;x<e.length;x++){let d=e[x];if(r&&h>0){if(d==="}"){h--,h===0&&(r=null);continue}let i=d.match(/^<<(\w+)>>$/);if(i){r.annotation=i[1];continue}let m=Ze(d);m&&(m.isMethod?r.methods.push(m.member):r.attributes.push(m.member));continue}let p=d.match(/^namespace\s+(\S+)\s*\{$/);if(p){t={name:p[1],classIds:[]};continue}if(d==="}"&&t){n.namespaces.push(t),t=null;continue}let g=d.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*\{$/);if(g){let i=g[1],m=g[2],f=de(s,i);m&&(f.label=`${i}<${m}>`),r=f,h=1,t&&t.classIds.push(i);continue}let a=d.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*$/);if(a){let i=a[1],m=a[2],f=de(s,i);m&&(f.label=`${i}<${m}>`),t&&t.classIds.push(i);continue}let u=d.match(/^class\s+(\S+?)\s*\{\s*<<(\w+)>>\s*\}$/);if(u){let i=de(s,u[1]);i.annotation=u[2];continue}let o=d.match(/^(\S+?)\s*:\s*(.+)$/);if(o){let i=o[2];if(!i.match(/<\|--|--|\*--|o--|-->|\.\.>|\.\.\|>/)){let m=de(s,o[1]),f=Ze(i);f&&(f.isMethod?m.methods.push(f.member):m.attributes.push(f.member));continue}}let l=Nt(d);if(l){de(s,l.from),de(s,l.to),n.relationships.push(l);continue}}return n.classes=[...s.values()],n}function de(e,n){let s=e.get(n);return s||(s={id:n,label:n,attributes:[],methods:[]},e.set(n,s)),s}function Ze(e){let n=e.trim().replace(/;$/,"");if(!n)return null;let s="",t=n;/^[+\-#~]/.test(t)&&(s=t[0],t=t.slice(1).trim());let r=t.match(/^(.+?)\(([^)]*)\)(?:\s*(.+))?$/);if(r){let a=r[1].trim(),u=r[3]?.trim(),o=a.endsWith("$")||t.includes("$"),l=a.endsWith("*")||t.includes("*");return{member:{visibility:s,name:a.replace(/[$*]$/,""),type:u||void 0,isStatic:o,isAbstract:l},isMethod:!0}}let h=t.split(/\s+/),x,d;h.length>=2?(d=h[0],x=h.slice(1).join(" ")):x=h[0]??t;let p=x.endsWith("$"),g=x.endsWith("*");return{member:{visibility:s,name:x.replace(/[$*]$/,""),type:d||void 0,isStatic:p,isAbstract:g},isMethod:!1}}function Nt(e){let n=e.match(/^(\S+?)\s+(?:"([^"]*?)"\s+)?(<\|--|<\|\.\.|\*--|o--|-->|--\*|--o|--|>\s*|\.\.>|\.\.\|>|--)\s+(?:"([^"]*?)"\s+)?(\S+?)(?:\s*:\s*(.+))?$/);if(!n)return null;let s=n[1],t=n[2]||void 0,r=n[3].trim(),h=n[4]||void 0,x=n[5],d=n[6]?.trim()||void 0,p=jt(r);return p?{from:s,to:x,type:p.type,markerAt:p.markerAt,label:d,fromCardinality:t,toCardinality:h}:null}function jt(e){switch(e){case"<|--":return{type:"inheritance",markerAt:"from"};case"<|..":return{type:"realization",markerAt:"from"};case"*--":return{type:"composition",markerAt:"from"};case"--*":return{type:"composition",markerAt:"to"};case"o--":return{type:"aggregation",markerAt:"from"};case"--o":return{type:"aggregation",markerAt:"to"};case"-->":return{type:"association",markerAt:"to"};case"..>":return{type:"dependency",markerAt:"to"};case"..|>":return{type:"realization",markerAt:"to"};case"--":return{type:"association",markerAt:"to"};default:return null}}function Wt(e){let n={entities:[],relationships:[]},s=new Map,t=null;for(let r=1;r<e.length;r++){let h=e[r];if(t){if(h==="}"){t=null;continue}let p=Bt(h);p&&t.attributes.push(p);continue}let x=h.match(/^(\S+)\s*\{$/);if(x){let p=x[1];t=Ae(s,p);continue}let d=Pt(h);if(d){Ae(s,d.entity1),Ae(s,d.entity2),n.relationships.push(d);continue}}return n.entities=[...s.values()],n}function Ae(e,n){let s=e.get(n);return s||(s={id:n,label:n,attributes:[]},e.set(n,s)),s}function Bt(e){let n=e.match(/^(\S+)\s+(\S+)(?:\s+(.+))?$/);if(!n)return null;let s=n[1],t=n[2],r=n[3]?.trim()??"",h=[],x,d=r.match(/"([^"]*)"/);d&&(x=d[1]);let p=r.replace(/"[^"]*"/,"").trim();for(let g of p.split(/\s+/)){let a=g.toUpperCase();(a==="PK"||a==="FK"||a==="UK")&&h.push(a)}return{type:s,name:t,keys:h,comment:x}}function Pt(e){let n=e.match(/^(\S+)\s+([|o}{]+(?:--|\.\.)[|o}{]+)\s+(\S+)\s*:\s*(.+)$/);if(!n)return null;let s=n[1],t=n[2],r=n[3],h=n[4].trim(),x=t.match(/^([|o}{]+)(--|\.\.?)([|o}{]+)$/);if(!x)return null;let d=x[1],p=x[2],g=x[3],a=et(d),u=et(g),o=p==="--";return!a||!u?null:{entity1:s,entity2:r,cardinality1:a,cardinality2:u,label:h,identifying:o}}function et(e){let n=e.split("").sort().join("");return n==="||"?"one":n==="o|"?"zero-one":n==="|}"||n==="{|"?"many":n==="{o"||n==="o{"?"zero-many":null}function Q(e,n,s){let t=s>=600?.58:s>=500?.55:.52;return e.length*n*t}function lt(e,n){return e.length*n*.6}var B={nodeLabel:13,edgeLabel:11,groupHeader:12},z={nodeLabel:500,edgeLabel:400,groupHeader:600},Xt=8,me={horizontal:16,vertical:10,diamondExtra:24},V={outerBox:1,innerBox:.75,connector:.75},q="0.35em",$e={width:8,height:4.8};function he(e,n,s,t){return{x:e-s/2,y:n-t/2}}function ke(e,n,s,t,r){let h=e.x-n,x=e.y-s;if(Math.abs(h)<.5&&Math.abs(x)<.5)return e;let d=1/(Math.abs(h)/t+Math.abs(x)/r);return{x:n+d*h,y:s+d*x}}function Ee(e,n,s,t){let r=e.x-n,h=e.y-s,x=Math.sqrt(r*r+h*h);if(x<.5)return e;let d=t/x;return{x:n+d*r,y:s+d*h}}function ye(e,n=!0){if(e.length<2)return e;let s=[e[0]];for(let t=1;t<e.length;t++){let r=s[s.length-1],h=e[t],x=Math.abs(h.x-r.x),d=Math.abs(h.y-r.y);if(x<1||d<1){s.push(h);continue}n?s.push({x:r.x,y:h.y}):s.push({x:h.x,y:r.y}),s.push(h)}return zt(s)}function zt(e){if(e.length<3)return e;let n=[e[0]];for(let s=1;s<e.length-1;s++){let t=n[n.length-1],r=e[s],h=e[s+1],x=Math.abs(t.x-r.x)<1&&Math.abs(r.x-h.x)<1,d=Math.abs(t.y-r.y)<1&&Math.abs(r.y-h.y)<1;x||d||n.push(r)}return n.push(e[e.length-1]),n}function Oe(e,n,s){if(e.length<2)return e;let t=e.map(r=>({...r}));if(s){let r=t.length-1;if(e.length===2){let h=t[0],x=t[r],d=Math.abs(x.x-h.x);if(Math.abs(x.y-h.y)>=d){let a=x.y>h.y?s.cy-s.hh:s.cy+s.hh;t[r]={x:x.x,y:a}}else{let a=x.x>h.x?s.cx-s.hw:s.cx+s.hw;t[r]={x:a,y:x.y}}}else{let h=t[r-1],x=t[r],d=Math.abs(x.x-h.x),p=Math.abs(x.y-h.y),g=p<1&&d>=1,a=d<1&&p>=1,u=!g&&!a&&p<d,o=!g&&!a&&d<p;if(g){let i=x.x>h.x?s.cx-s.hw:s.cx+s.hw;t[r]={x:i,y:s.cy},t[r-1]={...h,y:s.cy}}else if(a){let i=x.y>h.y?s.cy-s.hh:s.cy+s.hh;t[r]={x:s.cx,y:i},t[r-1]={...h,x:s.cx}}else if(u){let i=x.x>h.x?s.cx-s.hw:s.cx+s.hw;h.y>=s.cy-s.hh&&h.y<=s.cy+s.hh?t[r]={x:i,y:h.y}:(t[r]={x:i,y:s.cy},t[r-1]={...h,y:s.cy})}else if(o){let i=x.y>h.y?s.cy-s.hh:s.cy+s.hh;h.x>=s.cx-s.hw&&h.x<=s.cx+s.hw?t[r]={x:h.x,y:i}:(t[r]={x:s.cx,y:i},t[r-1]={...h,x:s.cx})}}}if(n&&e.length>=3){let r=t[0],h=t[1],x=Math.abs(h.x-r.x),d=Math.abs(h.y-r.y),p=d<1&&x>=1,g=x<1&&d>=1,a=!p&&!g&&d<x,u=!p&&!g&&x<d;if(p){let l=h.x>r.x?n.cx+n.hw:n.cx-n.hw;t[0]={x:l,y:n.cy},t[1]={...t[1],y:n.cy}}else if(g){let l=h.y>r.y?n.cy+n.hh:n.cy-n.hh;t[0]={x:n.cx,y:l},t[1]={...t[1],x:n.cx}}else if(a){let l=h.x>r.x?n.cx+n.hw:n.cx-n.hw;h.y>=n.cy-n.hh&&h.y<=n.cy+n.hh?t[0]={x:l,y:h.y}:(t[0]={x:l,y:n.cy},t[1]={...t[1],y:n.cy})}else if(u){let l=h.y>r.y?n.cy+n.hh:n.cy-n.hh;h.x>=n.cx-n.hw&&h.x<=n.cx+n.hw?t[0]={x:h.x,y:l}:(t[0]={x:n.cx,y:l},t[1]={...t[1],x:n.cx})}}return t}var Ce=new Set(["circle","doublecircle","state-start","state-end"]),Me=new Set(["diamond","circle","doublecircle","state-start","state-end"]),Ft={font:"Inter",padding:40,nodeSpacing:24,layerSpacing:40};function Gt(e,n,s){let t=new ae.default.graphlib.Graph({directed:!0,compound:!0});t.setGraph({rankdir:ct(e.direction),acyclicer:"greedy",nodesep:s.nodeSpacing,ranksep:s.layerSpacing,marginx:16,marginy:12}),t.setDefaultEdgeLabel(()=>({}));let r=new Set;r.add(e.id),je(e,r);for(let o of e.nodeIds){let l=n.nodes.get(o);if(l){let i=De(o,l.label,l.shape);t.setNode(o,{label:l.label,width:i.width,height:i.height})}}for(let o of e.children)Ne(t,o,n);let h=new Set;for(let o=0;o<n.edges.length;o++){let l=n.edges[o];if(r.has(l.source)&&r.has(l.target)){h.add(o);let i={_index:o};l.label&&(i.label=l.label,i.width=Q(l.label,B.edgeLabel,z.edgeLabel)+8,i.height=B.edgeLabel+6,i.labelpos="c"),t.setEdge(l.source,l.target,i)}}ae.default.layout(t);let x=e.direction==="TD"||e.direction==="TB"||e.direction==="BT",d=new Set;for(let o of e.children)Be(o,d);let p=[];for(let o of t.nodes()){if(d.has(o))continue;let l=n.nodes.get(o);if(!l)continue;let i=t.node(o);if(!i)continue;let m=he(i.x,i.y,i.width,i.height);p.push({id:o,label:l.label,shape:l.shape,x:m.x,y:m.y,width:i.width,height:i.height,inlineStyle:ht(n,o)})}let g=t.edges().map(o=>{let l=t.edge(o),i=n.edges[l._index],m=l.points??[];if(m.length>0){let v=n.nodes.get(o.v)?.shape;if(v==="diamond"){let M=t.node(o.v);m[0]=ke(m[0],M.x,M.y,M.width/2,M.height/2)}else if(v&&Ce.has(v)){let M=t.node(o.v);m[0]=Ee(m[0],M.x,M.y,Math.min(M.width,M.height)/2)}let k=n.nodes.get(o.w)?.shape;if(k==="diamond"){let M=t.node(o.w),I=m.length-1;m[I]=ke(m[I],M.x,M.y,M.width/2,M.height/2)}else if(k&&Ce.has(k)){let M=t.node(o.w),I=m.length-1;m[I]=Ee(m[I],M.x,M.y,Math.min(M.width,M.height)/2)}}let f=ye(m,x),c=n.nodes.get(o.v)?.shape,b=n.nodes.get(o.w)?.shape,w=c&&!Me.has(c)||!c?(()=>{let v=t.node(o.v);return v?{cx:v.x,cy:v.y,hw:v.width/2,hh:v.height/2}:null})():null,E=b&&!Me.has(b)||!b?(()=>{let v=t.node(o.w);return v?{cx:v.x,cy:v.y,hw:v.width/2,hh:v.height/2}:null})():null,L=Oe(f,w,E),y;return i.label&&l.x!=null&&l.y!=null&&(y={x:l.x,y:l.y}),{source:i.source,target:i.target,label:i.label,style:i.style,hasArrowStart:i.hasArrowStart,hasArrowEnd:i.hasArrowEnd,points:L,labelPosition:y}}),a=e.children.map(o=>We(t,o)),u=t.graph();return{id:e.id,label:e.label,width:u.width??200,height:u.height??100,nodes:p,edges:g,groups:a,nodeIds:r,internalEdgeIndices:h}}async function Vt(e,n={}){let s={...Ft,...n},t=new Map;for(let a of e.subgraphs)a.direction&&a.direction!==e.direction&&t.set(a.id,Gt(a,e,s));let r=new ae.default.graphlib.Graph({directed:!0,compound:!0});r.setGraph({rankdir:ct(e.direction),acyclicer:"greedy",nodesep:s.nodeSpacing,ranksep:s.layerSpacing,marginx:s.padding,marginy:s.padding}),r.setDefaultEdgeLabel(()=>({}));let h=new Set;for(let a of e.subgraphs)h.add(a.id),je(a,h);for(let[a,u]of e.nodes)if(!h.has(a)){let o=De(a,u.label,u.shape);r.setNode(a,{label:u.label,width:o.width,height:o.height})}for(let a of e.subgraphs)if(t.has(a.id)){let u=t.get(a.id);r.setNode(a.id,{width:u.width,height:u.height})}else Ne(r,a,e);let x=new Map,d=new Map;for(let a of e.subgraphs)t.has(a.id)||dt(a,x,d);for(let[a,u]of t)for(let o of u.nodeIds)x.set(o,a),d.set(o,a);let p=new Set;for(let a of t.values())for(let u of a.internalEdgeIndices)p.add(u);let g=new Set;for(let a=0;a<e.edges.length;a++){if(p.has(a))continue;let u=e.edges[a],o=d.get(u.source)??u.source,l=x.get(u.target)??u.target,i={_index:a};u.label&&(i.label=u.label,i.width=Q(u.label,B.edgeLabel,z.edgeLabel)+8,i.height=B.edgeLabel+6,i.labelpos="c"),g.has(l)||(i.weight=2,g.add(l)),r.setEdge(o,l,i)}try{ae.default.layout(r)}catch(a){let u=a instanceof Error?a.message:String(a);throw new Error(`Dagre layout failed: ${u}`)}return Ut(r,e,s.padding,t)}function ct(e){switch(e){case"LR":return"LR";case"RL":return"RL";case"BT":return"BT";default:return"TB"}}function De(e,n,s){let r=Q(n,B.nodeLabel,z.nodeLabel)+me.horizontal*2,h=B.nodeLabel+me.vertical*2;if(s==="diamond"){let x=Math.max(r,h)+me.diamondExtra;r=x,h=x}if(s==="circle"||s==="doublecircle"){let x=Math.ceil(Math.sqrt(r*r+h*h))+8;r=s==="doublecircle"?x+12:x,h=r}return s==="hexagon"&&(r+=me.horizontal),(s==="trapezoid"||s==="trapezoid-alt")&&(r+=me.horizontal),s==="asymmetric"&&(r+=12),s==="cylinder"&&(h+=14),(s==="state-start"||s==="state-end")&&(r=28,h=28),r=Math.max(r,60),h=Math.max(h,36),{width:r,height:h}}function Ne(e,n,s,t){e.setNode(n.id,{label:n.label}),t&&e.setParent(n.id,t);for(let r of n.nodeIds){let h=s.nodes.get(r);if(h){let x=De(r,h.label,h.shape);e.setNode(r,{label:h.label,width:x.width,height:x.height}),e.setParent(r,n.id)}}for(let r of n.children)Ne(e,r,s,n.id)}function dt(e,n,s){for(let x of e.children)dt(x,n,s);let t=[...e.nodeIds,...e.children.map(x=>x.id)];if(t.length===0){n.set(e.id,e.id),s.set(e.id,e.id);return}let r=t[0],h=t[t.length-1];n.set(e.id,n.get(r)??r),s.set(e.id,s.get(h)??h)}function ht(e,n){let s=e.classAssignments.get(n),t=s?e.classDefs.get(s):void 0,r=e.nodeStyles.get(n);if(!(!t&&!r))return{...t,...r}}function je(e,n){for(let s of e.nodeIds)n.add(s);for(let s of e.children)je(s,n)}function Ut(e,n,s,t){let r=[],h=[],x=new Set;for(let c of n.subgraphs)Be(c,x);let d=new Set;if(t)for(let c of t.values())for(let b of c.nodeIds)d.add(b);for(let c of e.nodes()){if(x.has(c))continue;let b=n.nodes.get(c);if(!b)continue;let w=e.node(c);if(!w)continue;let E=he(w.x,w.y,w.width,w.height);r.push({id:c,label:b.label,shape:b.shape,x:E.x,y:E.y,width:w.width,height:w.height,inlineStyle:ht(n,c)})}for(let c of n.subgraphs)h.push(We(e,c));let p=n.direction==="TD"||n.direction==="TB"||n.direction==="BT",g=e.edges().map(c=>{let b=e.edge(c),w=n.edges[b._index],E=b.points??[];if(E.length>0){let T=n.nodes.get(c.v)?.shape;if(T==="diamond"){let $=e.node(c.v);E[0]=ke(E[0],$.x,$.y,$.width/2,$.height/2)}else if(T&&Ce.has(T)){let $=e.node(c.v);E[0]=Ee(E[0],$.x,$.y,Math.min($.width,$.height)/2)}let D=n.nodes.get(c.w)?.shape;if(D==="diamond"){let $=e.node(c.w),C=E.length-1;E[C]=ke(E[C],$.x,$.y,$.width/2,$.height/2)}else if(D&&Ce.has(D)){let $=e.node(c.w),C=E.length-1;E[C]=Ee(E[C],$.x,$.y,Math.min($.width,$.height)/2)}}let L=ye(E,p),y=n.nodes.get(c.v)?.shape,v=n.nodes.get(c.w)?.shape,k=y&&!Me.has(y)||!y?(()=>{let T=e.node(c.v);return T?{cx:T.x,cy:T.y,hw:T.width/2,hh:T.height/2}:null})():null,M=v&&!Me.has(v)||!v?(()=>{let T=e.node(c.w);return T?{cx:T.x,cy:T.y,hw:T.width/2,hh:T.height/2}:null})():null,I=Oe(L,k,M),Y;return w.label&&b.x!=null&&b.y!=null&&(Y={x:b.x,y:b.y}),{source:w.source,target:w.target,label:w.label,style:w.style,hasArrowStart:w.hasArrowStart,hasArrowEnd:w.hasArrowEnd,points:I,labelPosition:Y}});if(t&&t.size>0){let c=new Map;for(let b of r)c.set(b.id,{cx:b.x+b.width/2,cy:b.y+b.height/2});for(let[b,w]of t){let E=e.node(b);if(!E)continue;let L=he(E.x,E.y,E.width,E.height);for(let v of w.nodes){let k={...v,x:v.x+L.x,y:v.y+L.y};r.push(k),c.set(k.id,{cx:k.x+k.width/2,cy:k.y+k.height/2})}for(let v of w.edges)g.push({...v,points:v.points.map(k=>({x:k.x+L.x,y:k.y+L.y})),labelPosition:v.labelPosition?{x:v.labelPosition.x+L.x,y:v.labelPosition.y+L.y}:void 0});let y=pt(h,b);y&&w.groups.length>0&&(y.children=w.groups.map(v=>gt(v,L.x,L.y)))}for(let b of g){if(d.has(b.source)&&d.has(b.target))continue;let w=!1;if(d.has(b.source)){let E=c.get(b.source);E&&b.points.length>0&&(b.points[0]={x:E.cx,y:E.cy},w=!0)}if(d.has(b.target)){let E=c.get(b.target);E&&b.points.length>0&&(b.points[b.points.length-1]={x:E.cx,y:E.cy},w=!0)}w&&(b.points=ye(b.points,p))}}let a=B.groupHeader+16;Jt(h,a);let u=ut(h),o=[...r.map(c=>c.y),...u.map(c=>c.y)],l=o.length>0?Math.min(...o):s,i=e.graph().width??800,m=e.graph().height??600;if(l<s){let c=s-l;for(let b of r)b.y+=c;for(let b of g){for(let w of b.points)w.y+=c;b.labelPosition&&(b.labelPosition.y+=c)}for(let b of u)b.y+=c;m+=c}let f=Math.max(...r.map(c=>c.y+c.height),...u.map(c=>c.y+c.height),...g.flatMap(c=>c.points.map(b=>b.y)));return f+s>m&&(m=f+s),{width:i,height:m,nodes:r,edges:g,groups:h}}function We(e,n){let s=e.node(n.id),t=s?he(s.x,s.y,s.width,s.height):{x:0,y:0};return{id:n.id,label:n.label,x:t.x,y:t.y,width:s?.width??0,height:s?.height??0,children:n.children.map(r=>We(e,r))}}function Jt(e,n){for(let s of e)ft(s,n)}function ft(e,n){for(let s of e.children)ft(s,n);if(e.children.length>0){let s=e.y,t=e.y+e.height;for(let r of e.children)s=Math.min(s,r.y),t=Math.max(t,r.y+r.height);e.height=t-s,e.y=s}if(e.label){let s=n+Xt;e.y-=s,e.height+=s}}function ut(e){let n=[];for(let s of e)n.push(s),n.push(...ut(s.children));return n}function pt(e,n){for(let s of e){if(s.id===n)return s;let t=pt(s.children,n);if(t)return t}}function gt(e,n,s){return{...e,x:e.x+n,y:e.y+s,children:e.children.map(t=>gt(t,n,s))}}function Be(e,n){n.add(e.id);for(let s of e.children)Be(s,n)}function Kt(e,n,s="Inter",t=!1){let r=[];r.push(Ie(e.width,e.height,n,t)),r.push(Se(s,!1)),r.push("<defs>"),r.push(qt()),r.push("</defs>");for(let h of e.groups)r.push(mt(h));for(let h of e.edges)r.push(Qt(h));for(let h of e.edges)h.label&&r.push(en(h));for(let h of e.nodes)r.push(nn(h));for(let h of e.nodes)r.push(yn(h));return r.push("</svg>"),r.join(`
`)}function qt(){let e=$e.width,n=$e.height;return`  <marker id="arrowhead" markerWidth="${e}" markerHeight="${n}" refX="${e}" refY="${n/2}" orient="auto">
    <polygon points="0 0, ${e} ${n/2}, 0 ${n}" fill="var(--_arrow)" />
  </marker>
  <marker id="arrowhead-start" markerWidth="${e}" markerHeight="${n}" refX="0" refY="${n/2}" orient="auto-start-reverse">
    <polygon points="${e} 0, 0 ${n/2}, ${e} ${n}" fill="var(--_arrow)" />
  </marker>`}function mt(e,n){let s=B.groupHeader+16,t=[];t.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" rx="0" ry="0" fill="var(--_group-fill)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`),t.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${s}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`),t.push(`<text x="${e.x+12}" y="${e.y+s/2}" dy="${q}" font-size="${B.groupHeader}" font-weight="${z.groupHeader}" fill="var(--_text-sec)">${Pe(e.label)}</text>`);for(let r of e.children)t.push(mt(r));return t.join(`
`)}function Qt(e){if(e.points.length<2)return"";let n=Zt(e.points),s=e.style==="dotted"?' stroke-dasharray="4 4"':"",t=e.style==="thick"?V.connector*2:V.connector,r="";return e.hasArrowEnd&&(r+=' marker-end="url(#arrowhead)"'),e.hasArrowStart&&(r+=' marker-start="url(#arrowhead-start)"'),`<polyline points="${n}" fill="none" stroke="var(--_line)" stroke-width="${t}"${s}${r} />`}function Zt(e){return e.map(n=>`${n.x},${n.y}`).join(" ")}function en(e,n){let s=e.labelPosition??tn(e.points),t=e.label,r=Q(t,B.edgeLabel,z.edgeLabel),h=8,x=r+h*2,d=B.edgeLabel+h*2;return`<rect x="${s.x-x/2}" y="${s.y-d/2}" width="${x}" height="${d}" rx="4" ry="4" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${s.x}" y="${s.y}" text-anchor="middle" dy="${q}" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${Pe(t)}</text>`}function tn(e){if(e.length===0)return{x:0,y:0};if(e.length===1)return e[0];let n=0;for(let t=1;t<e.length;t++)n+=tt(e[t-1],e[t]);let s=n/2;for(let t=1;t<e.length;t++){let r=tt(e[t-1],e[t]);if(s<=r){let h=s/r;return{x:e[t-1].x+h*(e[t].x-e[t-1].x),y:e[t-1].y+h*(e[t].y-e[t-1].y)}}s-=r}return e[e.length-1]}function tt(e,n){return Math.sqrt((n.x-e.x)**2+(n.y-e.y)**2)}function nn(e){let{x:n,y:s,width:t,height:r,shape:h,inlineStyle:x}=e,d=x?.fill??"var(--_node-fill)",p=x?.stroke??"var(--_node-stroke)",g=x?.["stroke-width"]??String(V.innerBox);switch(h){case"diamond":return ln(n,s,t,r,d,p,g);case"rounded":return rn(n,s,t,r,d,p,g);case"stadium":return sn(n,s,t,r,d,p,g);case"circle":return an(n,s,t,r,d,p,g);case"subroutine":return cn(n,s,t,r,d,p,g);case"doublecircle":return dn(n,s,t,r,d,p,g);case"hexagon":return hn(n,s,t,r,d,p,g);case"cylinder":return fn(n,s,t,r,d,p,g);case"asymmetric":return un(n,s,t,r,d,p,g);case"trapezoid":return pn(n,s,t,r,d,p,g);case"trapezoid-alt":return gn(n,s,t,r,d,p,g);case"state-start":return mn(n,s,t,r);case"state-end":return xn(n,s,t,r);default:return on(n,s,t,r,d,p,g)}}function on(e,n,s,t,r,h,x){return`<rect x="${e}" y="${n}" width="${s}" height="${t}" rx="0" ry="0" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function rn(e,n,s,t,r,h,x){return`<rect x="${e}" y="${n}" width="${s}" height="${t}" rx="6" ry="6" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function sn(e,n,s,t,r,h,x){let d=t/2;return`<rect x="${e}" y="${n}" width="${s}" height="${t}" rx="${d}" ry="${d}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function an(e,n,s,t,r,h,x){let d=e+s/2,p=n+t/2,g=Math.min(s,t)/2;return`<circle cx="${d}" cy="${p}" r="${g}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function ln(e,n,s,t,r,h,x){let d=e+s/2,p=n+t/2,g=s/2,a=t/2;return`<polygon points="${[`${d},${p-a}`,`${d+g},${p}`,`${d},${p+a}`,`${d-g},${p}`].join(" ")}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function cn(e,n,s,t,r,h,x){return`<rect x="${e}" y="${n}" width="${s}" height="${t}" rx="0" ry="0" fill="${r}" stroke="${h}" stroke-width="${x}" />
<line x1="${e+8}" y1="${n}" x2="${e+8}" y2="${n+t}" stroke="${h}" stroke-width="${x}" />
<line x1="${e+s-8}" y1="${n}" x2="${e+s-8}" y2="${n+t}" stroke="${h}" stroke-width="${x}" />`}function dn(e,n,s,t,r,h,x){let d=e+s/2,p=n+t/2,g=Math.min(s,t)/2,a=g-5;return`<circle cx="${d}" cy="${p}" r="${g}" fill="${r}" stroke="${h}" stroke-width="${x}" />
<circle cx="${d}" cy="${p}" r="${a}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function hn(e,n,s,t,r,h,x){let d=t/4;return`<polygon points="${[`${e+d},${n}`,`${e+s-d},${n}`,`${e+s},${n+t/2}`,`${e+s-d},${n+t}`,`${e+d},${n+t}`,`${e},${n+t/2}`].join(" ")}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function fn(e,n,s,t,r,h,x){let p=e+s/2,g=n+7,a=t-14;return`<rect x="${e}" y="${g}" width="${s}" height="${a}" fill="${r}" stroke="none" />
<line x1="${e}" y1="${g}" x2="${e}" y2="${g+a}" stroke="${h}" stroke-width="${x}" />
<line x1="${e+s}" y1="${g}" x2="${e+s}" y2="${g+a}" stroke="${h}" stroke-width="${x}" />
<ellipse cx="${p}" cy="${n+t-7}" rx="${s/2}" ry="7" fill="${r}" stroke="${h}" stroke-width="${x}" />
<ellipse cx="${p}" cy="${g}" rx="${s/2}" ry="7" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function un(e,n,s,t,r,h,x){return`<polygon points="${[`${e+12},${n}`,`${e+s},${n}`,`${e+s},${n+t}`,`${e+12},${n+t}`,`${e},${n+t/2}`].join(" ")}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function pn(e,n,s,t,r,h,x){let d=s*.15;return`<polygon points="${[`${e+d},${n}`,`${e+s-d},${n}`,`${e+s},${n+t}`,`${e},${n+t}`].join(" ")}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function gn(e,n,s,t,r,h,x){let d=s*.15;return`<polygon points="${[`${e},${n}`,`${e+s},${n}`,`${e+s-d},${n+t}`,`${e+d},${n+t}`].join(" ")}" fill="${r}" stroke="${h}" stroke-width="${x}" />`}function mn(e,n,s,t){let r=e+s/2,h=n+t/2,x=Math.min(s,t)/2-2;return`<circle cx="${r}" cy="${h}" r="${x}" fill="var(--_text)" stroke="none" />`}function xn(e,n,s,t){let r=e+s/2,h=n+t/2,x=Math.min(s,t)/2-2,d=x-4;return`<circle cx="${r}" cy="${h}" r="${x}" fill="none" stroke="var(--_text)" stroke-width="${V.innerBox*2}" />
<circle cx="${r}" cy="${h}" r="${d}" fill="var(--_text)" stroke="none" />`}function yn(e,n){if((e.shape==="state-start"||e.shape==="state-end")&&!e.label)return"";let s=e.x+e.width/2,t=e.y+e.height/2,r=e.inlineStyle?.color??"var(--_text)";return`<text x="${s}" y="${t}" text-anchor="middle" dy="${q}" font-size="${B.nodeLabel}" font-weight="${z.nodeLabel}" fill="${r}">${Pe(e.label)}</text>`}function Pe(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var X={padding:30,actorGap:140,actorHeight:40,actorPadX:16,headerGap:20,messageRowHeight:40,selfMessageHeight:30,activationWidth:10,blockPadX:10,blockPadTop:40,blockPadBottom:8,blockHeaderExtra:28,dividerExtra:24,noteWidth:120,notePadding:8,noteGap:10};function bn(e,n={}){if(e.actors.length===0)return{width:0,height:0,actors:[],lifelines:[],messages:[],activations:[],blocks:[],notes:[]};let s=e.actors.map(y=>{let v=Q(y.label,B.nodeLabel,z.nodeLabel);return Math.max(v+X.actorPadX*2,80)}),t=[],r=X.padding+s[0]/2;for(let y=0;y<e.actors.length;y++){if(y>0){let v=Math.max(X.actorGap,(s[y-1]+s[y])/2+40);r+=v}t.push(r)}let h=new Map;for(let y=0;y<e.actors.length;y++)h.set(e.actors[y].id,y);let x=X.padding,d=e.actors.map((y,v)=>({id:y.id,label:y.label,type:y.type,x:t[v],y:x,width:s[v],height:X.actorHeight})),p=x+X.actorHeight+X.headerGap,g=[],a=new Map;for(let y of e.blocks){let v=a.get(y.startIndex)??0;a.set(y.startIndex,Math.max(v,X.blockHeaderExtra));for(let k of y.dividers){let M=a.get(k.index)??0;a.set(k.index,Math.max(M,X.dividerExtra))}}let u=new Map,o=[];for(let y=0;y<e.messages.length;y++){let v=e.messages[y],k=h.get(v.from)??0,M=h.get(v.to)??0,I=v.from===v.to,Y=a.get(y)??0;Y>0&&(p+=Y);let T=t[k],D=t[M];if(g.push({from:v.from,to:v.to,label:v.label,lineStyle:v.lineStyle,arrowHead:v.arrowHead,x1:T,x2:D,y:p,isSelf:I}),v.activate&&(u.has(v.to)||u.set(v.to,[]),u.get(v.to).push(p)),v.deactivate){let $=u.get(v.from);if($&&$.length>0){let C=$.pop(),O=h.get(v.from)??0;o.push({actorId:v.from,x:t[O]-X.activationWidth/2,topY:C,bottomY:p,width:X.activationWidth})}}p+=I?X.selfMessageHeight+X.messageRowHeight:X.messageRowHeight}for(let[y,v]of u)for(let k of v){let M=h.get(y)??0;o.push({actorId:y,x:t[M]-X.activationWidth/2,topY:k,bottomY:p-X.messageRowHeight/2,width:X.activationWidth})}let l=e.blocks.map(y=>{let v=g[y.startIndex],k=g[y.endIndex],M=(v?.y??p)-X.blockPadTop,I=(k?.y??p)+X.blockPadBottom+12,Y=new Set;for(let S=y.startIndex;S<=y.endIndex;S++){let R=e.messages[S];R&&(Y.add(h.get(R.from)??0),Y.add(h.get(R.to)??0))}if(Y.size===0)for(let S=0;S<e.actors.length;S++)Y.add(S);let T=Math.min(...Y),D=Math.max(...Y),$=t[T]-s[T]/2-X.blockPadX,C=t[D]+s[D]/2+X.blockPadX,O=y.dividers.map(S=>{let R=g[S.index],j=R?.y??p,W=28;if(S.label&&R?.label){let F=`[${S.label}]`,ee=Q(F,B.edgeLabel,z.edgeLabel),re=$+8,Te=re+ee,be=Q(R.label,B.edgeLabel,z.edgeLabel),we=R.isSelf?R.x1+36:(R.x1+R.x2)/2-be/2,fe=we+be;Te>we&&re<fe&&(W=36)}return{y:j-W,label:S.label}});return{type:y.type,label:y.label,x:$,y:M,width:C-$,height:I-M,dividers:O}}),i=e.notes.map(y=>{let v=Math.max(X.noteWidth,Q(y.text,B.edgeLabel,z.edgeLabel)+X.notePadding*2),k=B.edgeLabel+X.notePadding*2,I=(g[y.afterIndex]?.y??x+X.actorHeight)+4,Y=h.get(y.actorIds[0]??"")??0,T;if(y.position==="left")T=t[Y]-s[Y]/2-v-X.noteGap;else if(y.position==="right")T=t[Y]+s[Y]/2+X.noteGap;else if(y.actorIds.length>1){let D=h.get(y.actorIds[y.actorIds.length-1]??"")??Y;T=(t[Y]+t[D])/2-v/2}else T=t[Y]-v/2;return{text:y.text,x:T,y:I,width:v,height:k}}),m=p+X.padding,f=X.padding,c=0;for(let y of d)f=Math.min(f,y.x-y.width/2),c=Math.max(c,y.x+y.width/2);for(let y of l)f=Math.min(f,y.x),c=Math.max(c,y.x+y.width);for(let y of i)f=Math.min(f,y.x),c=Math.max(c,y.x+y.width);let b=f<X.padding?X.padding-f:0;if(b>0){for(let y of d)y.x+=b;for(let y of g)y.x1+=b,y.x2+=b;for(let y of o)y.x+=b;for(let y of l)y.x+=b;for(let y of i)y.x+=b;for(let y=0;y<t.length;y++)t[y]+=b}let w=e.actors.map((y,v)=>({actorId:y.id,x:t[v],topY:x+X.actorHeight,bottomY:m-X.padding})),E=c+b+X.padding,L=m;return{width:Math.max(E,200),height:Math.max(L,100),actors:d,lifelines:w,messages:g,activations:o,blocks:l,notes:i}}function wn(e,n,s="Inter",t=!1){let r=[];r.push(Ie(e.width,e.height,n,t)),r.push(Se(s,!1)),r.push("<defs>"),r.push(vn()),r.push("</defs>");for(let h of e.blocks)r.push(Mn(h));for(let h of e.lifelines)r.push(kn(h));for(let h of e.activations)r.push(En(h));for(let h of e.messages)r.push(Cn(h));for(let h of e.notes)r.push(_n(h));for(let h of e.actors)r.push($n(h));return r.push("</svg>"),r.join(`
`)}function vn(){let e=$e.width,n=$e.height;return`  <marker id="seq-arrow" markerWidth="${e}" markerHeight="${n}" refX="${e}" refY="${n/2}" orient="auto-start-reverse">
    <polygon points="0 0, ${e} ${n/2}, 0 ${n}" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="${e}" markerHeight="${n}" refX="${e}" refY="${n/2}" orient="auto-start-reverse">
    <polyline points="0 0, ${e} ${n/2}, 0 ${n}" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>`}function $n(e){let{x:n,y:s,width:t,height:r,label:h,type:x}=e;if(x==="actor"){let p=r/24*.9,g=n-12*p,a=s+(r-24*p)/2,u=V.outerBox/p,o="var(--_line)";return`<g transform="translate(${g},${a}) scale(${p})">
  <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" fill="none" stroke="${o}" stroke-width="${u}" />
  <path d="M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10Z" fill="none" stroke="${o}" stroke-width="${u}" />
  <path d="M5.62842 18.3563C7.08963 17.0398 9.39997 16 12 16C14.6 16 16.9104 17.0398 18.3716 18.3563" fill="none" stroke="${o}" stroke-width="${u}" />
</g>
<text x="${n}" y="${s+r+14}" text-anchor="middle" font-size="${B.nodeLabel}" font-weight="${z.nodeLabel}" fill="var(--_text)">${ce(h)}</text>`}return`<rect x="${n-t/2}" y="${s}" width="${t}" height="${r}" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />
<text x="${n}" y="${s+r/2}" text-anchor="middle" dy="${q}" font-size="${B.nodeLabel}" font-weight="${z.nodeLabel}" fill="var(--_text)">${ce(h)}</text>`}function kn(e){return`<line x1="${e.x}" y1="${e.topY}" x2="${e.x}" y2="${e.bottomY}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`}function En(e){return`<rect x="${e.x}" y="${e.topY}" width="${e.width}" height="${e.bottomY-e.topY}" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${V.innerBox}" />`}function Cn(e){let n=[],s=e.lineStyle==="dashed"?' stroke-dasharray="6 4"':"",t=e.arrowHead==="filled"?"seq-arrow":"seq-arrow-open";if(e.isSelf)n.push(`<polyline points="${e.x1},${e.y} ${e.x1+30},${e.y} ${e.x1+30},${e.y+20} ${e.x2},${e.y+20}" fill="none" stroke="var(--_line)" stroke-width="${V.connector}"${s} marker-end="url(#${t})" />`),n.push(`<text x="${e.x1+30+6}" y="${e.y+20/2}" dy="${q}" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${ce(e.label)}</text>`);else{n.push(`<line x1="${e.x1}" y1="${e.y}" x2="${e.x2}" y2="${e.y}" stroke="var(--_line)" stroke-width="${V.connector}"${s} marker-end="url(#${t})" />`);let r=(e.x1+e.x2)/2;n.push(`<text x="${r}" y="${e.y-6}" text-anchor="middle" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${ce(e.label)}</text>`)}return n.join(`
`)}function Mn(e){let n=[];n.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`);let s=`${e.type}${e.label?` [${e.label}]`:""}`,t=Q(s,B.edgeLabel,z.groupHeader)+16,r=18;n.push(`<rect x="${e.x}" y="${e.y}" width="${t}" height="${r}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`),n.push(`<text x="${e.x+6}" y="${e.y+r/2}" dy="${q}" font-size="${B.edgeLabel}" font-weight="${z.groupHeader}" fill="var(--_text-sec)">${ce(s)}</text>`);for(let h of e.dividers)n.push(`<line x1="${e.x}" y1="${h.y}" x2="${e.x+e.width}" y2="${h.y}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`),h.label&&n.push(`<text x="${e.x+8}" y="${h.y+14}" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">[${ce(h.label)}]</text>`);return n.join(`
`)}function _n(e){return`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${V.innerBox}" />
<polygon points="${e.x+e.width-6},${e.y} ${e.x+e.width},${e.y+6} ${e.x+e.width-6},${e.y+6}" fill="var(--_inner-stroke)" />
<text x="${e.x+e.width/2}" y="${e.y+e.height/2}" text-anchor="middle" dy="${q}" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${ce(e.text)}</text>`}function ce(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var K={padding:40,boxPadX:8,headerBaseHeight:32,annotationHeight:16,memberRowHeight:20,sectionPadY:8,emptySectionHeight:8,minWidth:120,memberFontSize:11,nodeSpacing:40,layerSpacing:60};async function Ln(e,n={}){if(e.classes.length===0)return{width:0,height:0,classes:[],relationships:[]};let s=new Map;for(let d of e.classes){let p=d.annotation?K.headerBaseHeight+K.annotationHeight:K.headerBaseHeight,g=d.attributes.length>0?d.attributes.length*K.memberRowHeight+K.sectionPadY:K.emptySectionHeight,a=d.methods.length>0?d.methods.length*K.memberRowHeight+K.sectionPadY:K.emptySectionHeight,u=Q(d.label,B.nodeLabel,z.nodeLabel),o=nt(d.attributes),l=nt(d.methods),i=Math.max(K.minWidth,u+K.boxPadX*2,o+K.boxPadX*2,l+K.boxPadX*2),m=p+g+a;s.set(d.id,{width:i,height:m,headerHeight:p,attrHeight:g,methodHeight:a})}let t=new ae.default.graphlib.Graph({directed:!0});t.setGraph({rankdir:"TB",acyclicer:"greedy",nodesep:K.nodeSpacing,ranksep:K.layerSpacing,marginx:K.padding,marginy:K.padding}),t.setDefaultEdgeLabel(()=>({}));for(let d of e.classes){let p=s.get(d.id);t.setNode(d.id,{width:p.width,height:p.height})}for(let d=0;d<e.relationships.length;d++){let p=e.relationships[d],g={_index:d};p.label&&(g.label=p.label,g.width=Q(p.label,B.edgeLabel,z.edgeLabel)+8,g.height=B.edgeLabel+6,g.labelpos="c"),t.setEdge(p.from,p.to,g)}try{ae.default.layout(t)}catch(d){let p=d instanceof Error?d.message:String(d);throw new Error(`Dagre layout failed (class diagram): ${p}`)}let r=new Map;for(let d of e.classes)r.set(d.id,d);let h=e.classes.map(d=>{let p=t.node(d.id),g=s.get(d.id),a=he(p.x,p.y,p.width,p.height);return{id:d.id,label:d.label,annotation:d.annotation,attributes:d.attributes,methods:d.methods,x:a.x,y:a.y,width:p.width??g.width,height:p.height??g.height,headerHeight:g.headerHeight,attrHeight:g.attrHeight,methodHeight:g.methodHeight}}),x=t.edges().map(d=>{let p=t.edge(d),g=e.relationships[p._index],a=p.points??[],u=ye(a,!0),o=t.node(d.v),l=t.node(d.w),i=Oe(u,o?{cx:o.x,cy:o.y,hw:o.width/2,hh:o.height/2}:null,l?{cx:l.x,cy:l.y,hw:l.width/2,hh:l.height/2}:null),m;return g.label&&p.x!=null&&p.y!=null&&(m={x:p.x,y:p.y}),{from:g.from,to:g.to,type:g.type,markerAt:g.markerAt,label:g.label,fromCardinality:g.fromCardinality,toCardinality:g.toCardinality,points:i,labelPosition:m}});return{width:t.graph().width??600,height:t.graph().height??400,classes:h,relationships:x}}function nt(e){if(e.length===0)return 0;let n=0;for(let s of e){let t=Sn(s),r=lt(t,K.memberFontSize);r>n&&(n=r)}return n}function Sn(e){let n=e.visibility?`${e.visibility} `:"",s=e.type?`: ${e.type}`:"";return`${n}${e.name}${s}`}var _e={memberSize:11,memberWeight:400,annotationSize:10,annotationWeight:500};function In(e,n,s="Inter",t=!1){let r=[];r.push(Ie(e.width,e.height,n,t)),r.push(Se(s,!0)),r.push("<defs>"),r.push(On()),r.push("</defs>");for(let h of e.relationships)r.push(Rn(h));for(let h of e.classes)r.push(Tn(h));for(let h of e.relationships)r.push(An(h));return r.push("</svg>"),r.join(`
`)}function On(){return`  <marker id="cls-inherit" markerWidth="12" markerHeight="10" refX="12" refY="5" orient="auto-start-reverse">
    <polygon points="0 0, 12 5, 0 10" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-composition" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--_arrow)" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
  <marker id="cls-aggregation" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto-start-reverse">
    <polyline points="0 0, 8 3, 0 6" fill="none" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>`}function Tn(e){let{x:n,y:s,width:t,height:r,headerHeight:h,attrHeight:x,methodHeight:d}=e,p=[];p.push(`<rect x="${n}" y="${s}" width="${t}" height="${r}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`),p.push(`<rect x="${n}" y="${s}" width="${t}" height="${h}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`);let g=s+h/2;if(e.annotation){let l=s+12;p.push(`<text x="${n+t/2}" y="${l}" text-anchor="middle" dy="${q}" font-size="${_e.annotationSize}" font-weight="${_e.annotationWeight}" font-style="italic" fill="var(--_text-muted)">&lt;&lt;${le(e.annotation)}&gt;&gt;</text>`),g=s+h/2+6}p.push(`<text x="${n+t/2}" y="${g}" text-anchor="middle" dy="${q}" font-size="${B.nodeLabel}" font-weight="700" fill="var(--_text)">${le(e.label)}</text>`);let a=s+h;p.push(`<line x1="${n}" y1="${a}" x2="${n+t}" y2="${a}" stroke="var(--_node-stroke)" stroke-width="${V.innerBox}" />`);let u=20;for(let l=0;l<e.attributes.length;l++){let i=e.attributes[l],m=a+4+l*u+u/2;p.push(ot(i,n+K.boxPadX,m))}let o=a+x;p.push(`<line x1="${n}" y1="${o}" x2="${n+t}" y2="${o}" stroke="var(--_node-stroke)" stroke-width="${V.innerBox}" />`);for(let l=0;l<e.methods.length;l++){let i=e.methods[l],m=o+4+l*u+u/2;p.push(ot(i,n+K.boxPadX,m))}return p.join(`
`)}function ot(e,n,s){let t=e.isAbstract?' font-style="italic"':"",r=e.isStatic?' text-decoration="underline"':"",h=[];return e.visibility&&h.push(`<tspan fill="var(--_text-faint)">${le(e.visibility)} </tspan>`),h.push(`<tspan fill="var(--_text-sec)">${le(e.name)}</tspan>`),e.type&&(h.push('<tspan fill="var(--_text-faint)">: </tspan>'),h.push(`<tspan fill="var(--_text-muted)">${le(e.type)}</tspan>`)),`<text x="${n}" y="${s}" class="mono" dy="${q}" font-size="${_e.memberSize}" font-weight="${_e.memberWeight}"${t}${r}>${h.join("")}</text>`}function Rn(e){if(e.points.length<2)return"";let n=e.points.map(h=>`${h.x},${h.y}`).join(" "),t=e.type==="dependency"||e.type==="realization"?' stroke-dasharray="6 4"':"",r=Hn(e.type,e.markerAt);return`<polyline points="${n}" fill="none" stroke="var(--_line)" stroke-width="${V.connector}"${t}${r} />`}function Hn(e,n){let s=Yn(e);return s?n==="from"?` marker-start="url(#${s})"`:` marker-end="url(#${s})"`:""}function Yn(e){switch(e){case"inheritance":case"realization":return"cls-inherit";case"composition":return"cls-composition";case"aggregation":return"cls-aggregation";case"association":case"dependency":return"cls-arrow";default:return null}}function An(e){if(!e.label&&!e.fromCardinality&&!e.toCardinality||e.points.length<2)return"";let n=[];if(e.label){let s=e.labelPosition??Dn(e.points);n.push(`<text x="${s.x}" y="${s.y-8}" text-anchor="middle" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${le(e.label)}</text>`)}if(e.fromCardinality){let s=e.points[0],t=e.points[1],r=rt(s,t);n.push(`<text x="${s.x+r.x}" y="${s.y+r.y}" text-anchor="middle" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${le(e.fromCardinality)}</text>`)}if(e.toCardinality){let s=e.points[e.points.length-1],t=e.points[e.points.length-2],r=rt(s,t);n.push(`<text x="${s.x+r.x}" y="${s.y+r.y}" text-anchor="middle" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${le(e.toCardinality)}</text>`)}return n.join(`
`)}function Dn(e){if(e.length===0)return{x:0,y:0};let n=Math.floor(e.length/2);return e[n]}function rt(e,n){let s=n.x-e.x,t=n.y-e.y;return Math.abs(s)>Math.abs(t)?{x:s>0?14:-14,y:-10}:{x:-14,y:t>0?14:-14}}function le(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var oe={padding:40,boxPadX:12,headerHeight:32,rowHeight:22,minWidth:140,attrFontSize:11,nodeSpacing:50,layerSpacing:70};async function Nn(e,n={}){if(e.entities.length===0)return{width:0,height:0,entities:[],relationships:[]};let s=new Map;for(let d of e.entities){let p=Q(d.label,B.nodeLabel,z.nodeLabel),g=0;for(let o of d.attributes){let l=`${o.type}  ${o.name}${o.keys.length>0?"  "+o.keys.join(","):""}`,i=lt(l,oe.attrFontSize);i>g&&(g=i)}let a=Math.max(oe.minWidth,p+oe.boxPadX*2,g+oe.boxPadX*2),u=oe.headerHeight+Math.max(d.attributes.length,1)*oe.rowHeight;s.set(d.id,{width:a,height:u})}let t=new ae.default.graphlib.Graph({directed:!0});t.setGraph({rankdir:"LR",acyclicer:"greedy",nodesep:oe.nodeSpacing,ranksep:oe.layerSpacing,marginx:oe.padding,marginy:oe.padding}),t.setDefaultEdgeLabel(()=>({}));for(let d of e.entities){let p=s.get(d.id);t.setNode(d.id,{width:p.width,height:p.height})}for(let d=0;d<e.relationships.length;d++){let p=e.relationships[d];t.setEdge(p.entity1,p.entity2,{_index:d,label:p.label,width:Q(p.label,B.edgeLabel,z.edgeLabel)+8,height:B.edgeLabel+6,labelpos:"c"})}try{ae.default.layout(t)}catch(d){let p=d instanceof Error?d.message:String(d);throw new Error(`Dagre layout failed (ER diagram): ${p}`)}let r=new Map;for(let d of e.entities)r.set(d.id,d);let h=e.entities.map(d=>{let p=t.node(d.id),g=he(p.x,p.y,p.width,p.height);return{id:d.id,label:d.label,attributes:d.attributes,x:g.x,y:g.y,width:p.width??s.get(d.id).width,height:p.height??s.get(d.id).height,headerHeight:oe.headerHeight,rowHeight:oe.rowHeight}}),x=t.edges().map(d=>{let p=t.edge(d),g=e.relationships[p._index],a=p.points??[],u=ye(a,!1),o=t.node(d.v),l=t.node(d.w),i=Oe(u,o?{cx:o.x,cy:o.y,hw:o.width/2,hh:o.height/2}:null,l?{cx:l.x,cy:l.y,hw:l.width/2,hh:l.height/2}:null);return{entity1:g.entity1,entity2:g.entity2,cardinality1:g.cardinality1,cardinality2:g.cardinality2,label:g.label,identifying:g.identifying,points:i}});return{width:t.graph().width??600,height:t.graph().height??400,entities:h,relationships:x}}var ie={attrSize:11,attrWeight:400,keySize:9,keyWeight:600};function jn(e,n,s="Inter",t=!1){let r=[];r.push(Ie(e.width,e.height,n,t)),r.push(Se(s,!0)),r.push("<defs>"),r.push("</defs>");for(let h of e.relationships)r.push(Pn(h));for(let h of e.entities)r.push(Wn(h));for(let h of e.relationships)r.push(zn(h));for(let h of e.relationships)r.push(Xn(h));return r.push("</svg>"),r.join(`
`)}function Wn(e){let{x:n,y:s,width:t,height:r,headerHeight:h,rowHeight:x,label:d,attributes:p}=e,g=[];g.push(`<rect x="${n}" y="${s}" width="${t}" height="${r}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`),g.push(`<rect x="${n}" y="${s}" width="${t}" height="${h}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${V.outerBox}" />`),g.push(`<text x="${n+t/2}" y="${s+h/2}" text-anchor="middle" dy="${q}" font-size="${B.nodeLabel}" font-weight="700" fill="var(--_text)">${Le(d)}</text>`);let a=s+h;g.push(`<line x1="${n}" y1="${a}" x2="${n+t}" y2="${a}" stroke="var(--_node-stroke)" stroke-width="${V.innerBox}" />`);for(let u=0;u<p.length;u++){let o=p[u],l=a+u*x+x/2;g.push(Bn(o,n,l,t))}return p.length===0&&g.push(`<text x="${n+t/2}" y="${a+x/2}" text-anchor="middle" dy="${q}" font-size="${ie.attrSize}" fill="var(--_text-faint)" font-style="italic">(no attributes)</text>`),g.join(`
`)}function Bn(e,n,s,t){let r=[],h=0;if(e.keys.length>0){let p=e.keys.join(",");h=Q(p,ie.keySize,ie.keyWeight)+8,r.push(`<rect x="${n+6}" y="${s-7}" width="${h}" height="14" rx="2" ry="2" fill="var(--_key-badge)" />`),r.push(`<text x="${n+6+h/2}" y="${s}" text-anchor="middle" dy="${q}" font-size="${ie.keySize}" font-weight="${ie.keyWeight}" fill="var(--_text-sec)">${e.keys.join(",")}</text>`)}let x=n+8+(h>0?h+6:0);r.push(`<text x="${x}" y="${s}" class="mono" dy="${q}" font-size="${ie.attrSize}" font-weight="${ie.attrWeight}"><tspan fill="var(--_text-muted)">${Le(e.type)}</tspan></text>`);let d=n+t-8;return r.push(`<text x="${d}" y="${s}" class="mono" text-anchor="end" dy="${q}" font-size="${ie.attrSize}" font-weight="${ie.attrWeight}"><tspan fill="var(--_text-sec)">${Le(e.name)}</tspan></text>`),r.join(`
`)}function Pn(e){if(e.points.length<2)return"";let n=e.points.map(t=>`${t.x},${t.y}`).join(" "),s=e.identifying?"":' stroke-dasharray="6 4"';return`<polyline points="${n}" fill="none" stroke="var(--_line)" stroke-width="${V.connector}"${s} />`}function Xn(e){if(!e.label||e.points.length<2)return"";let n=Fn(e.points),t=Q(e.label,B.edgeLabel,z.edgeLabel)+8,r=B.edgeLabel+6;return`<rect x="${n.x-t/2}" y="${n.y-r/2}" width="${t}" height="${r}" rx="2" ry="2" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${n.x}" y="${n.y}" text-anchor="middle" dy="${q}" font-size="${B.edgeLabel}" font-weight="${z.edgeLabel}" fill="var(--_text-muted)">${Le(e.label)}</text>`}function zn(e){if(e.points.length<2)return"";let n=[],s=e.points[0],t=e.points[1];n.push(st(s,t,e.cardinality1));let r=e.points[e.points.length-1],h=e.points[e.points.length-2];return n.push(st(r,h,e.cardinality2)),n.join(`
`)}function st(e,n,s){let t=[],r=V.connector+.25,h=e.x-n.x,x=e.y-n.y,d=Math.sqrt(h*h+x*x);if(d===0)return"";let p=h/d,g=x/d,a=-g,u=p,o=e.x-p*4,l=e.y-g*4,i=e.x-p*16,m=e.y-g*16,f=s==="one"||s==="zero-one",c=s==="many"||s==="zero-many",b=s==="zero-one"||s==="zero-many";if(f){t.push(`<line x1="${o+a*6}" y1="${l+u*6}" x2="${o-a*6}" y2="${l-u*6}" stroke="var(--_line)" stroke-width="${r}" />`);let E=o-p*4,L=l-g*4;t.push(`<line x1="${E+a*6}" y1="${L+u*6}" x2="${E-a*6}" y2="${L-u*6}" stroke="var(--_line)" stroke-width="${r}" />`)}if(c){let E=o,L=l;t.push(`<line x1="${E+a*7}" y1="${L+u*7}" x2="${i}" y2="${m}" stroke="var(--_line)" stroke-width="${r}" />`),t.push(`<line x1="${E}" y1="${L}" x2="${i}" y2="${m}" stroke="var(--_line)" stroke-width="${r}" />`),t.push(`<line x1="${E-a*7}" y1="${L-u*7}" x2="${i}" y2="${m}" stroke="var(--_line)" stroke-width="${r}" />`)}if(b){let w=c?20:12,E=e.x-p*w,L=e.y-g*w;t.push(`<circle cx="${E}" cy="${L}" r="4" fill="var(--bg)" stroke="var(--_line)" stroke-width="${r}" />`)}return t.join(`
`)}function Fn(e){if(e.length===0)return{x:0,y:0};if(e.length===1)return e[0];let n=0;for(let r=1;r<e.length;r++){let h=e[r].x-e[r-1].x,x=e[r].y-e[r-1].y;n+=Math.sqrt(h*h+x*x)}if(n===0)return e[0];let s=n/2,t=0;for(let r=1;r<e.length;r++){let h=e[r].x-e[r-1].x,x=e[r].y-e[r-1].y,d=Math.sqrt(h*h+x*x);if(t+d>=s){let p=d>0?(s-t)/d:0;return{x:e[r-1].x+h*p,y:e[r-1].y+x*p}}t+=d}return e[e.length-1]}function Le(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Gn(e){let n=e.trim().split(`
`)[0]?.trim().toLowerCase()??"";return/^sequencediagram\s*$/.test(n)?"sequence":/^classdiagram\s*$/.test(n)?"class":/^erdiagram\s*$/.test(n)?"er":"flowchart"}function Vn(e){return{bg:e.bg??ve.bg,fg:e.fg??ve.fg,line:e.line,accent:e.accent,muted:e.muted,surface:e.surface,border:e.border}}async function xt(e,n={}){let s=Vn(n),t=n.font??"Inter",r=n.transparent??!1,h=Gn(e),x=e.split(`
`).map(d=>d.trim()).filter(d=>d.length>0&&!d.startsWith("%%"));switch(h){case"sequence":{let d=At(x),p=bn(d,n);return wn(p,s,t,r)}case"class":{let d=Dt(x),p=await Ln(d,n);return In(p,s,t,r)}case"er":{let d=Wt(x),p=await Nn(d,n);return jn(p,s,t,r)}default:{let d=_t(e),p=await Vt(d,n);return Kt(p,s,t,r)}}}window.beautifulMermaid={renderMermaid:xt,THEMES:it,DEFAULTS:ve};})();
